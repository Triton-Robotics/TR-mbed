<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TR-mbed: core/util/algorithms/eigen-3.4.0/Eigen/src/SVD/BDCSVD.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TR-mbed<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_459a7c9a427a2877b0db19c6b8d6e89d.html">util</a></li><li class="navelem"><a class="el" href="dir_2b91f87ecc8d5a52d8144fa162b6316d.html">algorithms</a></li><li class="navelem"><a class="el" href="dir_d26f9082d1b630c8fa4b82ce9b6be008.html">eigen-3.4.0</a></li><li class="navelem"><a class="el" href="dir_2db0027d82cbf4df3a553d443d05d16f.html">Eigen</a></li><li class="navelem"><a class="el" href="dir_2da3edace14031da0b2fd98f019d46df.html">src</a></li><li class="navelem"><a class="el" href="dir_3702a21b555680887b5055cd05c841c9.html">SVD</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">BDCSVD.h</div></div>
</div><!--header-->
<div class="contents">
<a href="BDCSVD_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// This file is part of Eigen, a lightweight C++ template library</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// for linear algebra.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// </span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// We used the &quot;A Divide-And-Conquer Algorithm for the Bidiagonal SVD&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// research report written by Ming Gu and Stanley C.Eisenstat</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// The code variable names correspond to the names they used in their </span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// report</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">//</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// Copyright (C) 2013 Gauthier Brun &lt;brun.gauthier@gmail.com&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// Copyright (C) 2013 Nicolas Carre &lt;nicolas.carre@ensimag.fr&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">// Copyright (C) 2013 Jean Ceccato &lt;jean.ceccato@ensimag.fr&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">// Copyright (C) 2013 Pierre Zoppitelli &lt;pierre.zoppitelli@ensimag.fr&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// Copyright (C) 2013 Jitse Niesen &lt;jitse@maths.leeds.ac.uk&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">// Copyright (C) 2014-2017 Gael Guennebaud &lt;gael.guennebaud@inria.fr&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">//</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">// Source Code Form is subject to the terms of the Mozilla</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">// Public License v. 2.0. If a copy of the MPL was not distributed</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#ifndef EIGEN_BDCSVD_H</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#define EIGEN_BDCSVD_H</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">// #define EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">// #define EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#undef eigen_internal_assert</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#define eigen_internal_assert(X) assert(X);</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceEigen.html">Eigen</a> {</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>IOFormat bdcsvdfmt(8, 0, <span class="stringliteral">&quot;, &quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;  [&quot;</span>, <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>  </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _MatrixType&gt; <span class="keyword">class </span>BDCSVD;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceinternal.html">internal</a> {</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _MatrixType&gt; </div>
<div class="foldopen" id="foldopen00041" data-start="{" data-end="};">
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html">   41</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structEigen_1_1internal_1_1traits.html">traits</a>&lt;<a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD</a>&lt;_MatrixType&gt; &gt;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        : <a class="code hl_struct" href="structEigen_1_1internal_1_1traits.html">traits</a>&lt;_MatrixType&gt;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>{</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html#afd85342058bafd2b0fd201db71b54f50">   44</a></span>  <span class="keyword">typedef</span> _MatrixType <a class="code hl_typedef" href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html#afd85342058bafd2b0fd201db71b54f50">MatrixType</a>;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>};  </div>
</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>} <span class="comment">// end namespace internal</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _MatrixType&gt; </div>
<div class="foldopen" id="foldopen00073" data-start="{" data-end="};">
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html">   73</a></span><span class="keyword">class </span><a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD</a> : <span class="keyword">public</span> <a class="code hl_class" href="classEigen_1_1SVDBase.html">SVDBase</a>&lt;BDCSVD&lt;_MatrixType&gt; &gt;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>{</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1SVDBase.html">SVDBase&lt;BDCSVD&gt;</a> <a class="code hl_class" href="classEigen_1_1SVDBase.html">Base</a>;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <span class="keyword">using </span><a class="code hl_function" href="classEigen_1_1SVDBase.html#ab1a0d1fcc818a876c3cb2b32887604be">Base::rows</a>;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  <span class="keyword">using </span><a class="code hl_function" href="classEigen_1_1SVDBase.html#a083d99e05949bab974bbff2966606b7f">Base::cols</a>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  <span class="keyword">using </span><a class="code hl_function" href="classEigen_1_1SVDBase.html#a705a7c2709e1624ccc19aa748a78d473">Base::computeU</a>;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="keyword">using </span><a class="code hl_function" href="classEigen_1_1SVDBase.html#a5f12efcb791eb007d4a4890ac5255ac4">Base::computeV</a>;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">   83</a></span>  <span class="keyword">typedef</span> _MatrixType <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">MatrixType</a>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aaeab2cfc3f87e2a2c595a9d5b4d97c71">   84</a></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> MatrixType::Scalar <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aaeab2cfc3f87e2a2c595a9d5b4d97c71">Scalar</a>;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">   85</a></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="classEigen_1_1Triplet.html">NumTraits&lt;typename MatrixType::Scalar&gt;::Real</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">RealScalar</a>;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">   86</a></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::Literal</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  <span class="keyword">enum</span> {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aa0222fb3be5089e2f7ca67e1e2882954">   88</a></span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aa0222fb3be5089e2f7ca67e1e2882954">RowsAtCompileTime</a> = MatrixType::RowsAtCompileTime, </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081af0a020e5fd77a8f6f2cfb7145c8da295">   89</a></span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081af0a020e5fd77a8f6f2cfb7145c8da295">ColsAtCompileTime</a> = MatrixType::ColsAtCompileTime, </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a135cfd5fd712f17e50bdc0efa61cc366">   90</a></span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a135cfd5fd712f17e50bdc0efa61cc366">DiagSizeAtCompileTime</a> = <a class="code hl_define" href="Macros_8h.html#a2a07ba221d47a7d636fd13678c8c75b3">EIGEN_SIZE_MIN_PREFER_DYNAMIC</a>(<a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aa0222fb3be5089e2f7ca67e1e2882954">RowsAtCompileTime</a>, <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081af0a020e5fd77a8f6f2cfb7145c8da295">ColsAtCompileTime</a>), </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a75ab90cba2fd1bdc327e07d349be1fd9">   91</a></span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a75ab90cba2fd1bdc327e07d349be1fd9">MaxRowsAtCompileTime</a> = MatrixType::MaxRowsAtCompileTime, </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a0d30a3a19367ab871e64a980aea219f0">   92</a></span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a0d30a3a19367ab871e64a980aea219f0">MaxColsAtCompileTime</a> = MatrixType::MaxColsAtCompileTime, </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081ab37c73c7ace3196b7a9b799a33492116">   93</a></span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081ab37c73c7ace3196b7a9b799a33492116">MaxDiagSizeAtCompileTime</a> = <a class="code hl_define" href="Macros_8h.html#af2d58514e6156c4da2d4af66fafd0b12">EIGEN_SIZE_MIN_PREFER_FIXED</a>(<a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a75ab90cba2fd1bdc327e07d349be1fd9">MaxRowsAtCompileTime</a>, <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a0d30a3a19367ab871e64a980aea219f0">MaxColsAtCompileTime</a>), </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <a class="code hl_enumvalue" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aaac5b9fa1cd1464ae3ec6ffa7b86a95d">MatrixOptions</a> = MatrixType::Options</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aaac5b9fa1cd1464ae3ec6ffa7b86a95d">   95</a></span>  };</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a4c38005126c75b1ba3b1b95117b4546d">   97</a></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="classEigen_1_1Matrix.html">Base::MatrixUType</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a4c38005126c75b1ba3b1b95117b4546d">MatrixUType</a>;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1a1140cddb7727637b5e33d9f3b13299">   98</a></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="classEigen_1_1Matrix.html">Base::MatrixVType</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1a1140cddb7727637b5e33d9f3b13299">MatrixVType</a>;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a44cd685aa8d3807c006f6557bd69abf8">   99</a></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="classEigen_1_1internal_1_1TensorLazyEvaluatorWritable.html">Base::SingularValuesType</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a44cd685aa8d3807c006f6557bd69abf8">SingularValuesType</a>;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#acf9211e5353d60fc3209d62fa0e2bdf7">  101</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Matrix.html">Matrix&lt;Scalar, Dynamic, Dynamic, ColMajor&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#acf9211e5353d60fc3209d62fa0e2bdf7">MatrixX</a>;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">  102</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Matrix.html">Matrix&lt;RealScalar, Dynamic, Dynamic, ColMajor&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a0ea2c57bf088d5fc480ad81945157079">  103</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Matrix.html">Matrix&lt;RealScalar, Dynamic, 1&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a0ea2c57bf088d5fc480ad81945157079">VectorType</a>;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1e177918a1acf8153ff5f323fbeed9fe">  104</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Array.html">Array&lt;RealScalar, Dynamic, 1&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1e177918a1acf8153ff5f323fbeed9fe">ArrayXr</a>;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a9dea0e28217993ad7de85351357724a7">  105</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Array.html">Array&lt;Index,1,Dynamic&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a9dea0e28217993ad7de85351357724a7">ArrayXi</a>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">  106</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Ref.html">Ref&lt;ArrayXr&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">  107</a></span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classEigen_1_1Ref.html">Ref&lt;ArrayXi&gt;</a> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">IndicesRef</a>;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="foldopen" id="foldopen00114" data-start="{" data-end="}">
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a39514816d38f9c418cf3f3514b511c2c">  114</a></span>  <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a39514816d38f9c418cf3f3514b511c2c">BDCSVD</a>() : <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">m_algoswap</a>(16), <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a01ac6b6ddf81569780bf6449e8484a6c">m_isTranspose</a>(false), <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a63dc95af59e08a68b11268e98feea7fa">m_compU</a>(false), <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a707ea2d37a7024a6317f001a6971fbec">m_compV</a>(false), <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">m_numIters</a>(0)</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  {}</div>
</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="foldopen" id="foldopen00124" data-start="{" data-end="}">
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a3e1fa48b3d042b7daf7392724a68bb60">  124</a></span>  <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a3e1fa48b3d042b7daf7392724a68bb60">BDCSVD</a>(<a class="code hl_typedef" href="classEigen_1_1SVDBase.html#a6229a37997eca1072b52cca5ee7a2bec">Index</a> <a class="code hl_function" href="classEigen_1_1BDCSVD.html#ab1a0d1fcc818a876c3cb2b32887604be">rows</a>, <a class="code hl_typedef" href="classEigen_1_1SVDBase.html#a6229a37997eca1072b52cca5ee7a2bec">Index</a> <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a083d99e05949bab974bbff2966606b7f">cols</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions = 0)</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    : <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">m_algoswap</a>(16), <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">m_numIters</a>(0)</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    allocate(<a class="code hl_function" href="classEigen_1_1BDCSVD.html#ab1a0d1fcc818a876c3cb2b32887604be">rows</a>, <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a083d99e05949bab974bbff2966606b7f">cols</a>, computationOptions);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  }</div>
</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="foldopen" id="foldopen00140" data-start="{" data-end="}">
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a302746d9c534cd513c1df87c7ae4850d">  140</a></span>  <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a302746d9c534cd513c1df87c7ae4850d">BDCSVD</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">MatrixType</a>&amp; <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions = 0)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    : <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">m_algoswap</a>(16), <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">m_numIters</a>(0)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>  {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">compute</a>(<a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>, computationOptions);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  }</div>
</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="foldopen" id="foldopen00146" data-start="{" data-end="}">
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#abdf2b178ad413766bc1b292fcef701e2">  146</a></span>  <a class="code hl_function" href="classEigen_1_1BDCSVD.html#abdf2b178ad413766bc1b292fcef701e2">~BDCSVD</a>() </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  }</div>
</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>  <a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD</a>&amp; <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">compute</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="benchmark-blocking-sizes_8cpp.html#af5fcaa2ea9f565466ca96c2992ea0771">MatrixType</a>&amp; <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="foldopen" id="foldopen00168" data-start="{" data-end="}">
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a61880a5f6dbf7a14f91be80eaa3a22bc">  168</a></span>  <a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD</a>&amp; <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a61880a5f6dbf7a14f91be80eaa3a22bc">compute</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">MatrixType</a>&amp; <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>)</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">compute</a>(<a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>, this-&gt;<a class="code hl_variable" href="classEigen_1_1SVDBase.html#a680646d2f3fa0de030cbf9b4815d6cda">m_computationOptions</a>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  }</div>
</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="foldopen" id="foldopen00173" data-start="{" data-end="}">
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aa21c0cc5e99c861970bae45d94cae9ad">  173</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="classEigen_1_1BDCSVD.html#aa21c0cc5e99c861970bae45d94cae9ad">setSwitchSize</a>(<span class="keywordtype">int</span> <a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  {</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <a class="code hl_define" href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>(s&gt;3 &amp;&amp; <span class="stringliteral">&quot;BDCSVD the size of the algo switch has to be greater than 3&quot;</span>);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">m_algoswap</a> = <a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>  }</div>
</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  <span class="keywordtype">void</span> allocate(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_function" href="classEigen_1_1BDCSVD.html#ab1a0d1fcc818a876c3cb2b32887604be">rows</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a083d99e05949bab974bbff2966606b7f">cols</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  <span class="keywordtype">void</span> divide(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <span class="keywordtype">void</span> computeSVDofM(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a>&amp; U, <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a>&amp; <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  <span class="keywordtype">void</span> computeSingVals(<span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; col0, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">IndicesRef</a>&amp; perm, <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a> shifts, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a> mus);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="keywordtype">void</span> perturbCol0(<span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; col0, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">IndicesRef</a>&amp; perm, <span class="keyword">const</span> <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; shifts, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; mus, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a> zhat);</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keywordtype">void</span> computeSingVecs(<span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; zhat, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">IndicesRef</a>&amp; perm, <span class="keyword">const</span> <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; shifts, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; mus, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a>&amp; U, <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a>&amp; <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  <span class="keywordtype">void</span> deflation43(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_function" href="structEigen_1_1EigenBase.html#a9f40726259520d7e9c5ce58d19d62e79">size</a>);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>  <span class="keywordtype">void</span> deflation44(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColu , <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColm, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_function" href="structEigen_1_1EigenBase.html#a9f40726259520d7e9c5ce58d19d62e79">size</a>);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="keywordtype">void</span> deflation(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> HouseholderU, <span class="keyword">typename</span> HouseholderV, <span class="keyword">typename</span> NaiveU, <span class="keyword">typename</span> NaiveV&gt;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <span class="keywordtype">void</span> copyUV(<span class="keyword">const</span> HouseholderU &amp;householderU, <span class="keyword">const</span> HouseholderV &amp;householderV, <span class="keyword">const</span> NaiveU &amp;naiveU, <span class="keyword">const</span> NaiveV &amp;naivev);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  <span class="keywordtype">void</span> structured_update(<a class="code hl_class" href="classEigen_1_1Block.html">Block&lt;MatrixXr,Dynamic,Dynamic&gt;</a> <a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a> &amp;<a class="code hl_class" href="classEigen_1_1Matrix.html">B</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n1);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  <span class="keyword">static</span> <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> secularEq(<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; col0, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">IndicesRef</a> &amp;perm, <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>&amp; diagShifted, <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> shift);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a857bb0e5f633e0600ea6861f14da8a1b">  195</a></span>  <a class="code hl_class" href="classEigen_1_1Matrix.html">MatrixXr</a> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a857bb0e5f633e0600ea6861f14da8a1b">m_naiveU</a>, <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a94b71ee8ecf0b6b621a1267cf136adc9">m_naiveV</a>;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a76dcaed5bc2dd1c37832805fa8fed943">  196</a></span>  <a class="code hl_class" href="classEigen_1_1Matrix.html">MatrixXr</a> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a76dcaed5bc2dd1c37832805fa8fed943">m_computed</a>;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a43bb7c5a142ebde4c38967c5c3d42910">  197</a></span>  <a class="code hl_typedef" href="classEigen_1_1SVDBase.html#a6229a37997eca1072b52cca5ee7a2bec">Index</a> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a43bb7c5a142ebde4c38967c5c3d42910">m_nRec</a>;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#ad62998546febd86ba715a9eae4c47b4b">  198</a></span>  <a class="code hl_class" href="classEigen_1_1Array.html">ArrayXr</a> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#ad62998546febd86ba715a9eae4c47b4b">m_workspace</a>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a8bfc4be4bdc669038298ea29b940532f">  199</a></span>  <a class="code hl_class" href="classEigen_1_1Array.html">ArrayXi</a> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a8bfc4be4bdc669038298ea29b940532f">m_workspaceI</a>;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">  200</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">m_algoswap</a>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a63dc95af59e08a68b11268e98feea7fa">  201</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a01ac6b6ddf81569780bf6449e8484a6c">m_isTranspose</a>, <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a63dc95af59e08a68b11268e98feea7fa">m_compU</a>, <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#a707ea2d37a7024a6317f001a6971fbec">m_compV</a>;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>  </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#ab71e31e61c33f68ff2f499ed9f30e718">Base::m_singularValues</a>;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#a6eca3829eb56684ca01c291c6630c8d8">Base::m_diagSize</a>;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#ad6f49fd8f826a41109f8eb68e2f48dc4">Base::m_computeFullU</a>;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#a1eec8ead08bc9cd1729ba9ba7beb6b41">Base::m_computeFullV</a>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#a47b67c55d69ba645bb7ae32bb5466138">Base::m_computeThinU</a>;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#ac8321ff2cbf3b82f5c2638b9de6661af">Base::m_computeThinV</a>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#af0e0b3833c1d49286c0fdcbc023c3bd8">Base::m_matrixU</a>;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#a69cf1cfb527ff5562156c13bdca45ca5">Base::m_matrixV</a>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#a447d2789c6fda585482933f9f0cd02af">Base::m_info</a>;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#a633b92f4eb9c65911b943b93bb8b341c">Base::m_isInitialized</a>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  <span class="keyword">using </span><a class="code hl_variable" href="classEigen_1_1SVDBase.html#aa41b395662650f2e10652f76365877c4">Base::m_nonzeroSingularValues</a>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span><span class="keyword">public</span>:  </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">  216</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">m_numIters</a>;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>}; <span class="comment">//end class BDCSVD</span></div>
</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment">// Method to allocate and initialize matrix and attributes</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="keywordtype">void</span> <a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::allocate</a>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions)</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>{</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  m_isTranspose = (<a class="code hl_variable" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a> &gt; <a class="code hl_variable" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  <span class="keywordflow">if</span> (Base::allocate(<a class="code hl_variable" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>, <a class="code hl_variable" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, computationOptions))</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  m_computed = MatrixXr::Zero(m_diagSize + 1, m_diagSize );</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  m_compU = computeV();</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  m_compV = computeU();</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keywordflow">if</span> (m_isTranspose)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    std::swap(m_compU, m_compV);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>  </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  <span class="keywordflow">if</span> (m_compU) m_naiveU = MatrixXr::Zero(m_diagSize + 1, m_diagSize + 1 );</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  <span class="keywordflow">else</span>         m_naiveU = MatrixXr::Zero(2, m_diagSize + 1 );</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="keywordflow">if</span> (m_compV) m_naiveV = MatrixXr::Zero(m_diagSize, m_diagSize);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  m_workspace.resize((m_diagSize+1)*(m_diagSize+1)*3);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>  m_workspaceI.resize(3*m_diagSize);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>}<span class="comment">// end allocate</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="foldopen" id="foldopen00245" data-start="{" data-end="}">
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">  245</a></span><a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;</a>&amp; <a class="code hl_function" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">BDCSVD&lt;MatrixType&gt;::compute</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">MatrixType</a>&amp; <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions) </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>{</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n\n======================================================================================================================\n\n\n&quot;</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  allocate(<a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>.rows(), <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>.cols(), computationOptions);</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">RealScalar</a> considerZero = (std::numeric_limits&lt;RealScalar&gt;::min)();</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>  </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  <span class="comment">//**** step -1 - If the problem is too small, directly falls back to JacobiSVD and return</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>.cols() &lt; m_algoswap)</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="comment">// FIXME this line involves temporaries</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <a class="code hl_class" href="classEigen_1_1JacobiSVD.html">JacobiSVD&lt;MatrixType&gt;</a> jsvd(<a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>,computationOptions);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    m_isInitialized = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    m_info = jsvd.<a class="code hl_function" href="classEigen_1_1SVDBase.html#a569913a15fa2f327121f155682368602">info</a>();</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <span class="keywordflow">if</span> (m_info == <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf">Success</a> || m_info == <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57">NoConvergence</a>) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>      <span class="keywordflow">if</span>(computeU()) m_matrixU = jsvd.<a class="code hl_function" href="classEigen_1_1SVDBase.html#accbc8e3f9baab3a57a6eba8e4cc3ea27">matrixU</a>();</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>      <span class="keywordflow">if</span>(computeV()) m_matrixV = jsvd.<a class="code hl_function" href="classEigen_1_1SVDBase.html#af09f06357d7d7442f7ca7343713756fe">matrixV</a>();</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      m_singularValues = jsvd.<a class="code hl_function" href="classEigen_1_1SVDBase.html#ac44c307a70731003003faf3a9bdf14f6">singularValues</a>();</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      m_nonzeroSingularValues = jsvd.<a class="code hl_function" href="classEigen_1_1SVDBase.html#afe8a555f38393a319a71ec0f0331c9ef">nonzeroSingularValues</a>();</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>  <span class="comment">//**** step 0 - Copy the input matrix and apply scaling to reduce over/under-flows</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>  <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">RealScalar</a> <a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a> = <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>.cwiseAbs().template maxCoeff&lt;PropagateNaN&gt;();</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <span class="keywordflow">if</span> (!(<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(<a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>)) {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    m_isInitialized = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    m_info = <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea580b2a3cafe585691e789f768fb729bf">InvalidInput</a>;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  }</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>==<a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) <a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a> = <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(1);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  <a class="code hl_class" href="classEigen_1_1Matrix.html">MatrixX</a> <a class="code hl_function" href="level1__impl_8h.html#aabd32585d834ced5249f811b38025e9d">copy</a>;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="keywordflow">if</span> (m_isTranspose) <a class="code hl_function" href="level1__impl_8h.html#aabd32585d834ced5249f811b38025e9d">copy</a> = <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>.adjoint()/<a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  <span class="keywordflow">else</span>               <a class="code hl_function" href="level1__impl_8h.html#aabd32585d834ced5249f811b38025e9d">copy</a> = <a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>/<a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  <span class="comment">//**** step 1 - Bidiagonalization</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>  <span class="comment">// FIXME this line involves temporaries</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>  <a class="code hl_struct" href="structEigen_1_1internal_1_1traits.html">internal::UpperBidiagonalization&lt;MatrixX&gt;</a> bid(<a class="code hl_function" href="level1__impl_8h.html#aabd32585d834ced5249f811b38025e9d">copy</a>);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  <span class="comment">//**** step 2 - Divide &amp; Conquer</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  m_naiveU.setZero();</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>  m_naiveV.setZero();</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>  <span class="comment">// FIXME this line involves a temporary matrix</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  m_computed.topRows(m_diagSize) = bid.bidiagonal().toDenseMatrix().transpose();</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>  m_computed.template bottomRows&lt;1&gt;().setZero();</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  divide(0, m_diagSize - 1, 0, 0, 0);</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>  <span class="keywordflow">if</span> (m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf">Success</a> &amp;&amp; m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57">NoConvergence</a>) {</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    m_isInitialized = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  }</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <span class="comment">//**** step 3 - Copy singular values and vectors</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;m_diagSize; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>  {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">RealScalar</a> <a class="code hl_variable" href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a> = <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(m_computed.coeff(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    m_singularValues.coeffRef(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code hl_variable" href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a> * <a class="code hl_variable" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a>&lt;considerZero)</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    {</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      m_nonzeroSingularValues = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      m_singularValues.tail(m_diagSize - <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1).setZero();</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    }</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == m_diagSize - 1)</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>      m_nonzeroSingularValues = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="comment">//   std::cout &lt;&lt; &quot;m_naiveU\n&quot; &lt;&lt; m_naiveU &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span><span class="comment">//   std::cout &lt;&lt; &quot;m_naiveV\n&quot; &lt;&lt; m_naiveV &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <span class="keywordflow">if</span>(m_isTranspose) copyUV(bid.householderV(), bid.householderU(), m_naiveV, m_naiveU);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <span class="keywordflow">else</span>              copyUV(bid.householderU(), bid.householderV(), m_naiveU, m_naiveV);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>  m_isInitialized = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>}<span class="comment">// end compute</span></div>
</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> HouseholderU, <span class="keyword">typename</span> HouseholderV, <span class="keyword">typename</span> NaiveU, <span class="keyword">typename</span> NaiveV&gt;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="keywordtype">void</span> <a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::copyUV</a>(<span class="keyword">const</span> HouseholderU &amp;householderU, <span class="keyword">const</span> HouseholderV &amp;householderV, <span class="keyword">const</span> NaiveU &amp;naiveU, <span class="keyword">const</span> NaiveV &amp;naiveV)</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>{</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>  <span class="comment">// Note exchange of U and V: m_matrixU is set from m_naiveV and vice versa</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>  <span class="keywordflow">if</span> (computeU())</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> Ucols = m_computeThinU ? m_diagSize : householderU.<a class="code hl_function" href="classEigen_1_1BDCSVD.html#a083d99e05949bab974bbff2966606b7f">cols</a>();</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    m_matrixU = MatrixX::Identity(householderU.cols(), Ucols);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    m_matrixU.topLeftCorner(m_diagSize, m_diagSize) = naiveV.template cast&lt;Scalar&gt;().topLeftCorner(m_diagSize, m_diagSize);</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    householderU.applyThisOnTheLeft(m_matrixU); <span class="comment">// FIXME this line involves a temporary buffer</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  <span class="keywordflow">if</span> (computeV())</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>  {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> Vcols = m_computeThinV ? m_diagSize : householderV.cols();</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    m_matrixV = MatrixX::Identity(householderV.cols(), Vcols);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    m_matrixV.topLeftCorner(m_diagSize, m_diagSize) = naiveU.template cast&lt;Scalar&gt;().topLeftCorner(m_diagSize, m_diagSize);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    householderV.applyThisOnTheLeft(m_matrixV); <span class="comment">// FIXME this line involves a temporary buffer</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>  }</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>}</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::structured_update(Block&lt;MatrixXr,Dynamic,Dynamic&gt; <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>, <span class="keyword">const</span> MatrixXr &amp;<a class="code hl_typedef" href="bench__gemm_8cpp.html#af60dc8214a22d8dfced07a33ec8e902d">B</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n1)</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>{</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>.rows();</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>&gt;100)</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>  {</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="comment">// If the matrices are large enough, let&#39;s exploit the sparse structure of A by</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <span class="comment">// splitting it in half (wrt n1), and packing the non-zero columns.</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n2 = <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - n1;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    Map&lt;MatrixXr&gt; A1(m_workspace.data()      , n1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    Map&lt;MatrixXr&gt; A2(m_workspace.data()+ n1*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, n2, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    Map&lt;MatrixXr&gt; B1(m_workspace.data()+  <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,  <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    Map&lt;MatrixXr&gt; B2(m_workspace.data()+2*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,  <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="foldopen" id="foldopen00372" data-start="{" data-end="}">
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno"><a class="line" href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837">  372</a></span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k1=0, k2=0;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0; <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>      <span class="keywordflow">if</span>( (<a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>.col(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).head(n1).array()!=Literal(0)).any() )</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>      {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        A1.col(k1) = <a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>.col(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).head(n1);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        B1.row(k1) = <a class="code hl_class" href="classEigen_1_1Matrix.html">B</a>.row(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        ++k1;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>      }</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>      <span class="keywordflow">if</span>( (<a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>.col(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).tail(n2).array()!=Literal(0)).any() )</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      {</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        A2.col(k2) = <a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>.col(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).tail(n2);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        B2.row(k2) = <a class="code hl_class" href="classEigen_1_1Matrix.html">B</a>.row(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        ++k2;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>      }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>.topRows(n1).noalias()    = A1.leftCols(k1) * B1.topRows(k1);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <a class="code hl_class" href="classEigen_1_1Matrix.html">A</a>.bottomRows(n2).noalias() = A2.leftCols(k2) * B2.topRows(k2);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  }</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>  {</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    Map&lt;MatrixXr,Aligned&gt; tmp(m_workspace.data(),<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    tmp.noalias() = <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>*<a class="code hl_typedef" href="bench__gemm_8cpp.html#af60dc8214a22d8dfced07a33ec8e902d">B</a>;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a> = tmp;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>  }</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>}</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span><span class="comment">// The divide algorithm is done &quot;in place&quot;, we are always working on subsets of the same matrix. The divide methods takes as argument the </span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span><span class="comment">// place of the submatrix we are currently working on.</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="comment">//@param firstCol : The Index of the first column of the submatrix of m_computed and for m_naiveU;</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="comment">//@param lastCol : The Index of the last column of the submatrix of m_computed and for m_naiveU; </span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="comment">// lastCol + 1 - firstCol is the size of the submatrix.</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="comment">//@param firstRowW : The Index of the first row of the matrix W that we are to change. (see the reference paper section 1 for more information on W)</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="comment">//@param firstRowW : Same as firstRowW with the column.</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span><span class="comment">//@param shift : Each time one takes the left submatrix, one must add 1 to the shift. Why? Because! We actually want the last column of the U submatrix </span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span><span class="comment">// to become the first column (*coeff) and to shift all the other columns to the right. There are more details on the reference paper.</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::divide(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> lastCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstRowW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstColW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> shift)</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>{</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>  <span class="comment">// requires rows = cols + 1;</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>  <span class="keyword">using </span>std::pow;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>  <span class="keyword">using </span>std::sqrt;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = lastCol - firstCol + 1;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>/2;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> considerZero = (std::numeric_limits&lt;RealScalar&gt;::min)();</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> alphaK;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> betaK; </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> r0; </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>, phi, c0, s0;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>  <a class="code hl_struct" href="structVectorType.html">VectorType</a> l, f;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  <span class="comment">// We use the other algorithm which is more efficient for small </span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  <span class="comment">// matrices.</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt; m_algoswap)</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>  {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="comment">// FIXME this line involves temporaries</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    JacobiSVD&lt;MatrixXr&gt; <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>(m_computed.block(firstCol, firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>), <a class="code hl_enumvalue" href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f">ComputeFullU</a> | (m_compV ? <a class="code hl_enumvalue" href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930">ComputeFullV</a> : 0));</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    m_info = <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>.info();</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <span class="keywordflow">if</span> (m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf">Success</a> &amp;&amp; m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57">NoConvergence</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="keywordflow">if</span> (m_compU)</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>      m_naiveU.block(firstCol, firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1).real() = <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>.matrixU();</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <span class="keywordflow">else</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    {</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>      m_naiveU.row(0).segment(firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1).real() = <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>.matrixU().row(0);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>      m_naiveU.row(1).segment(firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1).real() = <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>.matrixU().row(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    }</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="keywordflow">if</span> (m_compV) m_naiveV.block(firstRowW, firstColW, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>).real() = <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>.matrixV();</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    m_computed.block(firstCol + shift, firstCol + shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>).setZero();</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    m_computed.diagonal().segment(firstCol + shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>) = <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>.singularValues().head(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  }</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>  <span class="comment">// We use the divide and conquer algorithm</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  alphaK =  m_computed(firstCol + k, firstCol + k);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  betaK = m_computed(firstCol + k + 1, firstCol + k);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="comment">// The divide must be done in that order in order to have good results. Divide change the data inside the submatrices</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="comment">// and the divide of the right submatrice reads one column of the left submatrice. That&#39;s why we need to treat the </span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>  <span class="comment">// right submatrix before the left one. </span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>  divide(k + 1 + firstCol, lastCol, k + 1 + firstRowW, k + 1 + firstColW, shift);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  <span class="keywordflow">if</span> (m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf">Success</a> &amp;&amp; m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57">NoConvergence</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  divide(firstCol, k - 1 + firstCol, firstRowW, firstColW + 1, shift + 1);</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  <span class="keywordflow">if</span> (m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf">Success</a> &amp;&amp; m_info != <a class="code hl_enumvalue" href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57">NoConvergence</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <span class="keywordflow">if</span> (m_compU)</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    <a class="code hl_variable" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> = m_naiveU(firstCol + k, firstCol + k);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    phi = m_naiveU(firstCol + k + 1, lastCol + 1);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  } </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>  <span class="keywordflow">else</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <a class="code hl_variable" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> = m_naiveU(1, firstCol + k);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    phi = m_naiveU(0, lastCol + 1);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  r0 = <a class="code hl_function" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">sqrt</a>((<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(alphaK * <a class="code hl_variable" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>) * <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(alphaK * <a class="code hl_variable" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>)) + <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(betaK * phi) * <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(betaK * phi));</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  <span class="keywordflow">if</span> (m_compU)</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    l = m_naiveU.row(firstCol + k).segment(firstCol, k);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    f = m_naiveU.row(firstCol + k + 1).segment(firstCol + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k - 1);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>  } </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>  <span class="keywordflow">else</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    l = m_naiveU.row(1).segment(firstCol, k);</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    f = m_naiveU.row(0).segment(firstCol + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k - 1);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>  }</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  <span class="keywordflow">if</span> (m_compV) m_naiveV(firstRowW+k, firstColW) = Literal(1);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  <span class="keywordflow">if</span> (r0&lt;considerZero)</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  {</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    c0 = Literal(1);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    s0 = Literal(0);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>  }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>  {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    c0 = alphaK * <a class="code hl_variable" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> / r0;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    s0 = betaK * phi / r0;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>  }</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>  </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>  <span class="keywordflow">if</span> (m_compU)</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>  {</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    MatrixXr q1 (m_naiveU.col(firstCol + k).segment(firstCol, k + 1));     </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="comment">// we shiftW Q1 to the right</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = firstCol + k - 1; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= firstCol; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>--) </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>      m_naiveU.col(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1).segment(firstCol, k + 1) = m_naiveU.col(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).segment(firstCol, k + 1);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    <span class="comment">// we shift q1 at the left with a factor c0</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    m_naiveU.col(firstCol).segment( firstCol, k + 1) = (q1 * c0);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <span class="comment">// last column = q1 * - s0</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    m_naiveU.col(lastCol + 1).segment(firstCol, k + 1) = (q1 * ( - s0));</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    <span class="comment">// first column = q2 * s0</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    m_naiveU.col(firstCol).segment(firstCol + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k) = m_naiveU.col(lastCol + 1).segment(firstCol + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k) * s0; </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="comment">// q2 *= c0</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    m_naiveU.col(lastCol + 1).segment(firstCol + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k) *= c0;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  } </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="keywordflow">else</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  {</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> q1 = m_naiveU(0, firstCol + k);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <span class="comment">// we shift Q1 to the right</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = firstCol + k - 1; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= firstCol; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>--) </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>      m_naiveU(0, <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) = m_naiveU(0, <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    <span class="comment">// we shift q1 at the left with a factor c0</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    m_naiveU(0, firstCol) = (q1 * c0);</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    <span class="comment">// last column = q1 * - s0</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    m_naiveU(0, lastCol + 1) = (q1 * ( - s0));</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="comment">// first column = q2 * s0</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    m_naiveU(1, firstCol) = m_naiveU(1, lastCol + 1) *s0; </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="comment">// q2 *= c0</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    m_naiveU(1, lastCol + 1) *= c0;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    m_naiveU.row(1).segment(firstCol + 1, k).setZero();</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    m_naiveU.row(0).segment(firstCol + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k - 1).setZero();</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>  </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  m_computed(firstCol + shift, firstCol + shift) = r0;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>  m_computed.col(firstCol + shift).segment(firstCol + shift + 1, k) = alphaK * l.transpose().real();</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>  m_computed.col(firstCol + shift).segment(firstCol + shift + k + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> - k - 1) = betaK * f.transpose().real();</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  ArrayXr tmp1 = (m_computed.block(firstCol+shift, firstCol+shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>)).jacobiSvd().singularValues();</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>  <span class="comment">// Second part: try to deflate singular values in combined matrix</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>  deflation(firstCol, lastCol, k, firstRowW, firstColW, shift);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  ArrayXr tmp2 = (m_computed.block(firstCol+shift, firstCol+shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>)).jacobiSvd().singularValues();</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\n\nj1 = &quot;</span> &lt;&lt; tmp1.transpose().format(bdcsvdfmt) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;j2 = &quot;</span> &lt;&lt; tmp2.transpose().format(bdcsvdfmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;err:      &quot;</span> &lt;&lt; ((tmp1-tmp2).<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>()&gt;1<a class="code hl_function" href="Cwise__array__power__array_8cpp.html#a9cb86ff854760bf91a154f2724a9101d">e</a>-12*tmp2.abs()).transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="ref__serial_8h.html#a20302e2c99a60d3f612dba57e3f6333b">count</a> = 0;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; ++<a class="code hl_variable" href="ref__serial_8h.html#a20302e2c99a60d3f612dba57e3f6333b">count</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>  assert((tmp1-tmp2).<a class="code hl_function" href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a>().norm() &lt; 1<a class="code hl_function" href="Cwise__array__power__array_8cpp.html#a9cb86ff854760bf91a154f2724a9101d">e</a>-14*tmp2.matrix().norm());</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span><span class="comment">//   assert(count&lt;681);</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span><span class="comment">//   assert(((tmp1-tmp2).abs()&lt;1e-13*tmp2.abs()).all());</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="comment">// Third part: compute SVD of combined matrix</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  MatrixXr UofSVD, VofSVD;</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  <a class="code hl_struct" href="structVectorType.html">VectorType</a> singVals;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  computeSVDofM(firstCol + shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, UofSVD, singVals, VofSVD);</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  assert(UofSVD.allFinite());</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>  assert(VofSVD.allFinite());</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>  </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <span class="keywordflow">if</span> (m_compU)</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    structured_update(m_naiveU.block(firstCol, firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1), UofSVD, (<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+2)/2);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    Map&lt;Matrix&lt;RealScalar,2,Dynamic&gt;,<a class="code hl_enumvalue" href="group__enums.html#gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8">Aligned</a>&gt; tmp(m_workspace.data(),2,<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>    tmp.noalias() = m_naiveU.middleCols(firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1) * UofSVD;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    m_naiveU.middleCols(firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> + 1) = tmp;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>  </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="keywordflow">if</span> (m_compV)  structured_update(m_naiveV.block(firstRowW, firstColW, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>), VofSVD, (<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1)/2);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  m_computed.block(firstCol + shift, firstCol + shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>).setZero();</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  m_computed.block(firstCol + shift, firstCol + shift, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>).diagonal() = singVals;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>}<span class="comment">// end divide</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span><span class="comment">// Compute SVD of m_computed.block(firstCol, firstCol, n + 1, n); this block only has non-zeros in</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span><span class="comment">// the first column and on the diagonal and has undergone deflation, so diagonal is in increasing</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span><span class="comment">// order except for possibly the (0,0) entry. The computed SVD is stored U, singVals and V, except</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span><span class="comment">// that if m_compV is false, then V is not computed. Singular values are sorted in decreasing order.</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span><span class="comment">//</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="comment">// TODO Opportunities for optimization: better root finding algo, better stopping criterion, better</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="comment">// handling of round-off errors, be consistent in ordering</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">// For instance, to solve the secular equation using FMM, see http://www.stat.uchicago.edu/~lekheng/courses/302/classics/greengard-rokhlin.pdf</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::computeSVDofM(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, MatrixXr&amp; U, <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals, MatrixXr&amp; <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>)</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>{</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> considerZero = (std::numeric_limits&lt;RealScalar&gt;::min)();</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  ArrayRef col0 = m_computed.col(firstCol).segment(firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  m_workspace.head(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>) =  m_computed.block(firstCol, firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>).diagonal();</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  ArrayRef diag = m_workspace.head(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  diag(0) = Literal(0);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <span class="comment">// Allocate space for singular values and vectors</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  singVals.resize(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  U.resize(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <span class="keywordflow">if</span> (m_compV) <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.resize(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>  <span class="keywordflow">if</span> (col0.hasNaN() || diag.hasNaN())</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\n\nHAS NAN\n\n&quot;</span>;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>  <span class="comment">// Many singular values might have been deflated, the zero ones have been moved to the end,</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>  <span class="comment">// but others are interleaved and we must ignore them at this stage.</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  <span class="comment">// To this end, let&#39;s compute a permutation skipping them:</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> actual_n = <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  <span class="keywordflow">while</span>(actual_n&gt;1 &amp;&amp; diag(actual_n-1)==Literal(0)) {--actual_n; <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(col0(actual_n)==Literal(0)); }</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = 0; <span class="comment">// size of the deflated problem</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k=0;k&lt;actual_n;++k)</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    <span class="keywordflow">if</span>(<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(col0(k))&gt;considerZero)</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>      m_workspaceI(<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>++) = k;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>  Map&lt;ArrayXi&gt; perm(m_workspaceI.data(),<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>);</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  Map&lt;ArrayXr&gt; shifts(m_workspace.data()+1*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  Map&lt;ArrayXr&gt; mus(m_workspace.data()+2*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  Map&lt;ArrayXr&gt; zhat(m_workspace.data()+3*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;computeSVDofM using:\n&quot;</span>;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  z: &quot;</span> &lt;&lt; col0.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  d: &quot;</span> &lt;&lt; diag.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="comment">// Compute singVals, shifts, and mus</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>  computeSingVals(col0, diag, perm, singVals, shifts, mus);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  j:        &quot;</span> &lt;&lt; (m_computed.block(firstCol, firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>)).jacobiSvd().singularValues().transpose().reverse() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  sing-val: &quot;</span> &lt;&lt; singVals.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  mu:       &quot;</span> &lt;&lt; mus.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  shift:    &quot;</span> &lt;&lt; shifts.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>  </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  {</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n    mus:    &quot;</span> &lt;&lt; mus.head(actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;    check1 (expect0) : &quot;</span> &lt;&lt; ((singVals.array()-(shifts+mus)) / singVals.array()).<a class="code hl_function" href="BlockMethods_8h.html#af652402b7c3103c3e9f6c62d51e8d490">head</a>(actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    assert((((singVals.array()-(shifts+mus)) / singVals.array()).head(actual_n) &gt;= 0).all());</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;    check2 (&gt;0)      : &quot;</span> &lt;&lt; ((singVals.array()-diag) / singVals.array()).<a class="code hl_function" href="BlockMethods_8h.html#af652402b7c3103c3e9f6c62d51e8d490">head</a>(actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    assert((((singVals.array()-diag) / singVals.array()).head(actual_n) &gt;= 0).all());</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  }</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  assert(singVals.allFinite());</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>  assert(mus.allFinite());</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  assert(shifts.allFinite());</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  <span class="comment">// Compute zhat</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  perturbCol0(col0, diag, perm, singVals, shifts, mus, zhat);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  zhat: &quot;</span> &lt;&lt; zhat.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  assert(zhat.allFinite());</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  computeSingVecs(zhat, diag, perm, singVals, shifts, mus, U, <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  </div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;U^T U: &quot;</span> &lt;&lt; (U.transpose() * U - MatrixXr(MatrixXr::Identity(U.cols(),U.cols()))).norm() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;V^T V: &quot;</span> &lt;&lt; (<a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.transpose() * <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a> - MatrixXr(MatrixXr::Identity(<a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.cols(),<a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.cols()))).norm() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  </div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  assert(U.allFinite());</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  assert(<a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.allFinite());</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span><span class="comment">//   assert((U.transpose() * U - MatrixXr(MatrixXr::Identity(U.cols(),U.cols()))).norm() &lt; 100*NumTraits&lt;RealScalar&gt;::epsilon() * n);</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="comment">//   assert((V.transpose() * V - MatrixXr(MatrixXr::Identity(V.cols(),V.cols()))).norm() &lt; 100*NumTraits&lt;RealScalar&gt;::epsilon() * n);</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>  </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>  <span class="comment">// Because of deflation, the singular values might not be completely sorted.</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <span class="comment">// Fortunately, reordering them is a O(n) problem</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>  <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;actual_n-1; ++<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  {</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    <span class="keywordflow">if</span>(singVals(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&gt;singVals(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1))</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      <span class="keyword">using </span>std::swap;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>      <a class="code hl_function" href="level1__impl_8h.html#a2b21b715d5c8616e8517a1d18923cc73">swap</a>(singVals(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),singVals(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1));</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>      U.col(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).swap(U.col(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1));</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>      <span class="keywordflow">if</span>(m_compV) <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.col(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).swap(<a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.col(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1));</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    }</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  }</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  {</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <span class="keywordtype">bool</span> singular_values_sorted = (((singVals.segment(1,actual_n-1)-singVals.head(actual_n-1))).array() &gt;= 0).all();</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="keywordflow">if</span>(!singular_values_sorted)</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Singular values are not sorted: &quot;</span> &lt;&lt; singVals.segment(1,actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    assert(singular_values_sorted);</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  }</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <span class="comment">// Reverse order so that singular values in increased order</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>  <span class="comment">// Because of deflation, the zeros singular-values are already at the end</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  singVals.head(actual_n).reverseInPlace();</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>  U.leftCols(actual_n).rowwise().reverseInPlace();</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  <span class="keywordflow">if</span> (m_compV) <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.leftCols(actual_n).rowwise().reverseInPlace();</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>  </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>  JacobiSVD&lt;MatrixXr&gt; jsvd(m_computed.block(firstCol, firstCol, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>) );</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  * j:        &quot;</span> &lt;&lt; jsvd.singularValues().transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  * sing-val: &quot;</span> &lt;&lt; singVals.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span><span class="comment">//   std::cout &lt;&lt; &quot;  * err:      &quot; &lt;&lt; ((jsvd.singularValues()-singVals)&gt;1e-13*singVals.norm()).transpose() &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>}</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span><span class="keyword">typename</span> <a class="code hl_typedef" href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">BDCSVD&lt;MatrixType&gt;::RealScalar</a> BDCSVD&lt;MatrixType&gt;::secularEq(<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> mu, <span class="keyword">const</span> ArrayRef&amp; col0, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef &amp;perm, <span class="keyword">const</span> ArrayRef&amp; diagShifted, <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> shift)</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>{</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = perm.size();</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a> = Literal(1);</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>; ++<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  {</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = perm(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    <span class="comment">// The following expression could be rewritten to involve only a single division,</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="comment">// but this would make the expression more sensitive to overflow.</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    <a class="code hl_variable" href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a> += (col0(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) / (diagShifted(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) - mu)) * (col0(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) / (diag(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) + shift + mu));</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>  }</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span> </div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>}</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::computeSingVals(<span class="keyword">const</span> ArrayRef&amp; col0, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef &amp;perm,</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                                         <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals, ArrayRef shifts, ArrayRef mus)</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>{</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>  <span class="keyword">using </span>std::swap;</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>  <span class="keyword">using </span>std::sqrt;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = col0.size();</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> actual_n = <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>;</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  <span class="comment">// Note that here actual_n is computed based on col0(i)==0 instead of diag(i)==0 as above</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>  <span class="comment">// because 1) we have diag(i)==0 =&gt; col0(i)==0 and 2) if col0(i)==0, then diag(i) is already a singular value.</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>  <span class="keywordflow">while</span>(actual_n&gt;1 &amp;&amp; col0(actual_n-1)==Literal(0)) --actual_n;</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span> </div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = 0; k &lt; <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++k)</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>  {</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    <span class="keywordflow">if</span> (col0(k) == Literal(0) || actual_n==1)</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    {</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>      <span class="comment">// if col0(k) == 0, then entry is deflated, so singular value is on diagonal</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>      <span class="comment">// if actual_n==1, then the deflated problem is already diagonalized</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>      singVals(k) = k==0 ? col0(0) : diag(k);</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>      mus(k) = Literal(0);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>      shifts(k) = k==0 ? col0(0) : diag(k);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    } </div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span> </div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="comment">// otherwise, use secular equation to find singular value</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> left = diag(k);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> right; <span class="comment">// was: = (k != actual_n-1) ? diag(k+1) : (diag(actual_n-1) + col0.matrix().norm());</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="keywordflow">if</span>(k==actual_n-1)</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>      right = (diag(actual_n-1) + col0.matrix().norm());</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    {</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      <span class="comment">// Skip deflated singular values,</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>      <span class="comment">// recall that at this stage we assume that z[j]!=0 and all entries for which z[j]==0 have been put aside.</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>      <span class="comment">// This should be equivalent to using perm[]</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>      <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l = k+1;</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>      <span class="keywordflow">while</span>(col0(l)==Literal(0)) { ++l; <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(l&lt;actual_n); }</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>      right = diag(l);</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    }</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    <span class="comment">// first decide whether it&#39;s closer to the left end or the right end</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> mid = left + (right-left) / Literal(2);</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fMid = secularEq(mid, col0, diag, perm, diag, Literal(0));</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;right-left = &quot;</span> &lt;&lt; right-left &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span><span class="comment">//     std::cout &lt;&lt; &quot;fMid = &quot; &lt;&lt; fMid &lt;&lt; &quot; &quot; &lt;&lt; secularEq(mid-left, col0, diag, perm, ArrayXr(diag-left), left)</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="comment">//                            &lt;&lt; &quot; &quot; &lt;&lt; secularEq(mid-right, col0, diag, perm, ArrayXr(diag-right), right)   &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;     = &quot;</span> &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.000001)*(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.1)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.2)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.3)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.4)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.49)    *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.5)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.51)    *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.6)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.7)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.8)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.9)     *(right-left), col0, diag, perm, diag, 0)</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(left+<a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.999999)*(right-left), col0, diag, perm, diag, 0) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> shift = (k == actual_n-1 || fMid &gt; Literal(0)) ? left : right;</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <span class="comment">// measure everything relative to shift</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    Map&lt;ArrayXr&gt; diagShifted(m_workspace.data()+4*<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    diagShifted = diag - shift;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span> </div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    <span class="keywordflow">if</span>(k!=actual_n-1)</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>    {</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      <span class="comment">// check that after the shift, f(mid) is still negative:</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> midShifted = (right - left) / <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(2);</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>      <span class="keywordflow">if</span>(shift==right)</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>        midShifted = -midShifted;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fMidShifted = secularEq(midShifted, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>      <span class="keywordflow">if</span>(fMidShifted&gt;0)</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>      {</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        <span class="comment">// fMid was erroneous, fix it:</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        shift =  fMidShifted &gt; Literal(0) ? left : right;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        diagShifted = diag - shift;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>      }</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    }</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    </div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="comment">// initial guess</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> muPrev, muCur;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    <span class="keywordflow">if</span> (shift == left)</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    {</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>      muPrev = (right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.1);</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>      <span class="keywordflow">if</span> (k == actual_n-1) muCur = right - left;</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>      <span class="keywordflow">else</span>                 muCur = (right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.5);</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    }</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    {</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>      muPrev = -(right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.1);</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>      muCur = -(right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.5);</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>    }</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fPrev = secularEq(muPrev, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fCur = secularEq(muCur, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(fPrev) &lt; <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(fCur))</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>      <a class="code hl_function" href="level1__impl_8h.html#a2b21b715d5c8616e8517a1d18923cc73">swap</a>(fPrev, fCur);</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>      <a class="code hl_function" href="level1__impl_8h.html#a2b21b715d5c8616e8517a1d18923cc73">swap</a>(muPrev, muCur);</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    }</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    <span class="comment">// rational interpolation: fit a function of the form a / mu + b through the two previous</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    <span class="comment">// iterates and use its zero to compute the next iterate</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    <span class="keywordtype">bool</span> useBisection = fPrev*fCur&gt;Literal(0);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    <span class="keywordflow">while</span> (fCur!=Literal(0) &amp;&amp; <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(muCur - muPrev) &gt; Literal(8) * NumTraits&lt;RealScalar&gt;::epsilon() * numext::maxi&lt;RealScalar&gt;(<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(muCur), <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(muPrev)) &amp;&amp; <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(fCur - fPrev)&gt;NumTraits&lt;RealScalar&gt;::epsilon() &amp;&amp; !useBisection)</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    {</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>      ++m_numIters;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span> </div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>      <span class="comment">// Find a and b such that the function f(mu) = a / mu + b matches the current and previous samples.</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a> = (fCur - fPrev) / (Literal(1)/muCur - Literal(1)/muPrev);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a> = fCur - <a class="code hl_variable" href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a> / muCur;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>      <span class="comment">// And find mu such that f(mu)==0:</span></div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> muZero = -<a class="code hl_variable" href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a>/<a class="code hl_variable" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fZero = secularEq(muZero, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span> </div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>      assert((<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(fZero));</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>      </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>      muPrev = muCur;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>      fPrev = fCur;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>      muCur = muZero;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      fCur = fZero;</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>      </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>      <span class="keywordflow">if</span> (shift == left  &amp;&amp; (muCur &lt; Literal(0) || muCur &gt; right - left)) useBisection = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>      <span class="keywordflow">if</span> (shift == right &amp;&amp; (muCur &lt; -(right - left) || muCur &gt; Literal(0))) useBisection = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(fCur)&gt;<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(fPrev)) useBisection = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    }</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span> </div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    <span class="comment">// fall back on bisection method if rational interpolation did not work</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="keywordflow">if</span> (useBisection)</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    {</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;useBisection for k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, actual_n = &quot;</span> &lt;&lt; actual_n &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> leftShifted, rightShifted;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>      <span class="keywordflow">if</span> (shift == left)</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>      {</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        <span class="comment">// to avoid overflow, we must have mu &gt; max(real_min, |z(k)|/sqrt(real_max)),</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="comment">// the factor 2 is to be more conservative</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        leftShifted = numext::maxi&lt;RealScalar&gt;( (std::numeric_limits&lt;RealScalar&gt;::min)(), Literal(2) * <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(col0(k)) / <a class="code hl_function" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">sqrt</a>((std::numeric_limits&lt;RealScalar&gt;::max)()) );</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        <span class="comment">// check that we did it right:</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>( (<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)( (col0(k)/leftShifted)*(col0(k)/(diag(k)+shift+leftShifted)) ) );</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>        <span class="comment">// I don&#39;t understand why the case k==0 would be special there:</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>        <span class="comment">// if (k == 0) rightShifted = right - left; else</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>        rightShifted = (k==actual_n-1) ? right : ((right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.51)); <span class="comment">// theoretically we can take 0.5, but let&#39;s be safe</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>      }</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>      {</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        leftShifted = -(right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.51);</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>        <span class="keywordflow">if</span>(k+1&lt;<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>)</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>          rightShifted = -numext::maxi&lt;RealScalar&gt;( (std::numeric_limits&lt;RealScalar&gt;::min)(), <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(col0(k+1)) / <a class="code hl_function" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">sqrt</a>((std::numeric_limits&lt;RealScalar&gt;::max)()) );</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>          rightShifted = -(std::numeric_limits&lt;RealScalar&gt;::min)();</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>      }</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fLeft = secularEq(leftShifted, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>      <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(fLeft&lt;Literal(0));</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span><span class="preprocessor">#if defined EIGEN_INTERNAL_DEBUGGING || defined EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> fRight = secularEq(rightShifted, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>      <span class="keywordflow">if</span>(!(<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(fLeft))</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;f(&quot;</span> &lt;&lt; leftShifted &lt;&lt; <span class="stringliteral">&quot;) =&quot;</span> &lt;&lt; fLeft &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; shift &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; right &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>      assert((<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(fLeft));</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span> </div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>      <span class="keywordflow">if</span>(!(<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(fRight))</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;f(&quot;</span> &lt;&lt; rightShifted &lt;&lt; <span class="stringliteral">&quot;) =&quot;</span> &lt;&lt; fRight &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; shift &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; right &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>      <span class="comment">// assert((numext::isfinite)(fRight));</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>      <span class="keywordflow">if</span>(!(fLeft * fRight&lt;0))</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>      {</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;f(leftShifted) using  leftShifted=&quot;</span> &lt;&lt; leftShifted &lt;&lt; <span class="stringliteral">&quot; ;  diagShifted(1:10):&quot;</span> &lt;&lt; diagShifted.head(10).transpose()  &lt;&lt; <span class="stringliteral">&quot;\n ; &quot;</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>                  &lt;&lt; <span class="stringliteral">&quot;left==shift=&quot;</span> &lt;&lt; bool(left==shift) &lt;&lt; <span class="stringliteral">&quot; ; left-shift = &quot;</span> &lt;&lt; (left-shift) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;  fLeft &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; fRight &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; fLeft * fRight &lt;&lt; <span class="stringliteral">&quot;  ;  &quot;</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>                  &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot; .. &quot;</span> &lt;&lt; right &lt;&lt; <span class="stringliteral">&quot;] -&gt; [&quot;</span> &lt;&lt; leftShifted &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rightShifted &lt;&lt; <span class="stringliteral">&quot;], shift=&quot;</span> &lt;&lt; shift</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>                  &lt;&lt; <span class="stringliteral">&quot; ,  f(right)=&quot;</span> &lt;&lt; secularEq(0,     col0, diag, perm, diagShifted, shift)</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>                           &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; secularEq(right, col0, diag, perm, diag, 0) &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; fRight &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>      }</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>      <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(fLeft * fRight &lt; Literal(0));</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span> </div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>      <span class="keywordflow">if</span>(fLeft&lt;Literal(0))</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>      {</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>        <span class="keywordflow">while</span> (rightShifted - leftShifted &gt; Literal(2) * NumTraits&lt;RealScalar&gt;::epsilon() * numext::maxi&lt;RealScalar&gt;(<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(leftShifted), <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(rightShifted)))</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>        {</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>          <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> midShifted = (leftShifted + rightShifted) / Literal(2);</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>          fMid = secularEq(midShifted, col0, diag, perm, diagShifted, shift);</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>          <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>((<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(fMid));</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span> </div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>          <span class="keywordflow">if</span> (fLeft * fMid &lt; Literal(0))</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>          {</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            rightShifted = midShifted;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>          }</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>          {</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>            leftShifted = midShifted;</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            fLeft = fMid;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>          }</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>        }</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        muCur = (leftShifted + rightShifted) / Literal(2);</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>      }</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>      <span class="keywordflow">else</span> </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>      {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        <span class="comment">// We have a problem as shifting on the left or right give either a positive or negative value</span></div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <span class="comment">// at the middle of [left,right]...</span></div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        <span class="comment">// Instead fo abbording or entering an infinite loop,</span></div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <span class="comment">// let&#39;s just use the middle as the estimated zero-crossing:</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        muCur = (right - left) * <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.5);</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        <span class="keywordflow">if</span>(shift == right)</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>          muCur = -muCur;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>      }</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    }</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    singVals[k] = shift + muCur;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>    shifts[k] = shift;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    mus[k] = muCur;</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    <span class="keywordflow">if</span>(k+1&lt;<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>)</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;found &quot;</span> &lt;&lt; singVals[k] &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; shift &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; muCur &lt;&lt; <span class="stringliteral">&quot; from &quot;</span> &lt;&lt; diag(k) &lt;&lt; <span class="stringliteral">&quot; .. &quot;</span>  &lt;&lt; diag(k+1) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    assert(k==0 || singVals[k]&gt;=singVals[k-1]);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    assert(singVals[k]&gt;=diag(k));</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span> </div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    <span class="comment">// perturb singular value slightly if it equals diagonal entry to avoid division by zero later</span></div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    <span class="comment">// (deflation is supposed to avoid this from happening)</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    <span class="comment">// - this does no seem to be necessary anymore -</span></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span><span class="comment">//     if (singVals[k] == left) singVals[k] *= 1 + NumTraits&lt;RealScalar&gt;::epsilon();</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span><span class="comment">//     if (singVals[k] == right) singVals[k] *= 1 - NumTraits&lt;RealScalar&gt;::epsilon();</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>  }</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>}</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span> </div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="comment">// zhat is perturbation of col0 for which singular vectors can be computed stably (see Section 3.1)</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::perturbCol0</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>   (<span class="keyword">const</span> ArrayRef&amp; col0, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef &amp;perm, <span class="keyword">const</span> <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals,</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    <span class="keyword">const</span> ArrayRef&amp; shifts, <span class="keyword">const</span> ArrayRef&amp; mus, ArrayRef zhat)</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>{</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>  <span class="keyword">using </span>std::sqrt;</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = col0.size();</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = perm.size();</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>==0)</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>  {</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    zhat.setZero();</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>  }</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastIdx = perm(<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>-1);</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>  <span class="comment">// The offset permits to skip deflated entries while computing zhat</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = 0; k &lt; <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++k)</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  {</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    <span class="keywordflow">if</span> (col0(k) == Literal(0)) <span class="comment">// deflated</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>      zhat(k) = Literal(0);</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      <span class="comment">// see equation (3.6)</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> dk = diag(k);</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a> = (singVals(lastIdx) + dk) * (mus(lastIdx) + (shifts(lastIdx) - dk));</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a>&lt;0) {</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; ;  z(k)=&quot;</span> &lt;&lt; col0(k) &lt;&lt; <span class="stringliteral">&quot;, diag(k)=&quot;</span> &lt;&lt; dk &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;prod = &quot;</span> &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; singVals(lastIdx) &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; dk &lt;&lt; <span class="stringliteral">&quot;) * (&quot;</span> &lt;&lt; mus(lastIdx) &lt;&lt; <span class="stringliteral">&quot; + (&quot;</span> &lt;&lt; shifts(lastIdx) &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; dk &lt;&lt; <span class="stringliteral">&quot;))&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;     = &quot;</span> &lt;&lt; singVals(lastIdx) + dk &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; mus(lastIdx) + (shifts(lastIdx) - dk) &lt;&lt;  <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>      }</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>      assert(<a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a>&gt;=0);</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span> </div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>      <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l = 0; l&lt;<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>; ++l)</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>      {</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>        <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = perm(l);</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>!=k)</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>        {</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>          <span class="keywordflow">if</span>(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;=k &amp;&amp; (l==0 || l-1&gt;=<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>))</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>          {</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Error in perturbCol0\n&quot;</span>;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; l &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; col0(k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; diag(k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt;  <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt;diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>            <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = (<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;k <span class="comment">/*|| l==0*/</span>) ? <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> : perm(l-1);</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <span class="stringliteral">&quot;j=&quot;</span> &lt;&lt; <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>          }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>          <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;k ? <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> : perm(l-1);</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>          <span class="keywordflow">if</span>(!(dk!=Literal(0) || diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)!=Literal(0)))</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>          {</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, i=&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;, l=&quot;</span> &lt;&lt; l &lt;&lt; <span class="stringliteral">&quot;, perm.size()=&quot;</span> &lt;&lt; perm.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>          }</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>          assert(dk!=Literal(0) || diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)!=Literal(0));</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>          <a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a> *= ((singVals(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+dk) / ((diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+dk))) * ((mus(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+(shifts(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-dk)) / ((diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-dk)));</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>          assert(<a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a>&gt;=0);</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>          <span class="keywordflow">if</span>(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>!=k &amp;&amp; <a class="code hl_function" href="namespaceEigen_1_1numext.html#ac09cd9261a50a46dd4937868020c7c45">numext::abs</a>(((singVals(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+dk)*(mus(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+(shifts(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-dk)))/((diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+dk)*(diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-dk)) - 1) &gt; 0.9 )</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; ((singVals(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+dk)*(mus(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+(shifts(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-dk)))/((diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+dk)*(diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-dk)) &lt;&lt; <span class="stringliteral">&quot; == (&quot;</span> &lt;&lt; (singVals(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+dk) &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; (mus(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)+(shifts(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-dk))</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>                       &lt;&lt; <span class="stringliteral">&quot;) / (&quot;</span> &lt;&lt; (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+dk) &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-dk) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>        }</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>      }</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;zhat(&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;) =  sqrt( &quot;</span> &lt;&lt; <a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a> &lt;&lt; <span class="stringliteral">&quot;)  ;  &quot;</span> &lt;&lt; (singVals(lastIdx) + dk) &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; mus(lastIdx) + shifts(lastIdx) &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; dk &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>      <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> tmp = <a class="code hl_function" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">sqrt</a>(<a class="code hl_function" href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">prod</a>);</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>      assert((<a class="code hl_function" href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">numext::isfinite</a>)(tmp));</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>      zhat(k) = col0(k) &gt; Literal(0) ? <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(tmp) : <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(-tmp);</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    }</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  }</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>}</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span> </div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span><span class="comment">// compute singular vectors</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::computeSingVecs</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>   (<span class="keyword">const</span> ArrayRef&amp; zhat, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef &amp;perm, <span class="keyword">const</span> <a class="code hl_struct" href="structVectorType.html">VectorType</a>&amp; singVals,</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    <span class="keyword">const</span> ArrayRef&amp; shifts, <span class="keyword">const</span> ArrayRef&amp; mus, MatrixXr&amp; U, MatrixXr&amp; <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>)</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>{</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = zhat.size();</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = perm.size();</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>  </div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = 0; k &lt; <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++k)</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>  {</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    <span class="keywordflow">if</span> (zhat(k) == Literal(0))</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    {</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>      U.col(k) = VectorType::Unit(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1, k);</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>      <span class="keywordflow">if</span> (m_compV) <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.col(k) = VectorType::Unit(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, k);</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>    }</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    {</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>      U.col(k).setZero();</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>      <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l=0;l&lt;<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>;++l)</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>      {</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>        <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = perm(l);</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>        U(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,k) = zhat(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)/(((diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) - shifts(k)) - mus(k)) )/( (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + singVals[k]));</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>      }</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>      U(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,k) = Literal(0);</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>      U.col(k).normalize();</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>    </div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>      <span class="keywordflow">if</span> (m_compV)</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>      {</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>        <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.col(k).setZero();</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>        <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l=1;l&lt;<a class="code hl_variable" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>;++l)</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>        {</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>          <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = perm(l);</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>          <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,k) = diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * zhat(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) / (((diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) - shifts(k)) - mus(k)) )/( (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + singVals[k]));</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>        }</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>(0,k) = Literal(-1);</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>        <a class="code hl_variable" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>.col(k).normalize();</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>      }</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    }</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>  }</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>  U.col(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>) = VectorType::Unit(<a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1, <a class="code hl_variable" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>}</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span> </div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span> </div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="comment">// page 12_13</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="comment">// i &gt;= 1, di almost null and zi non null.</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="comment">// We use a rotation to zero out zi applied to the left of M</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::deflation43(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> shift, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>)</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>{</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>  <span class="keyword">using </span>std::sqrt;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>  <span class="keyword">using </span>std::pow;</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>  <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> start = firstCol + shift;</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a> = m_computed(start, start);</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a> = m_computed(start+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, start);</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> r = numext::hypot(<a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a>,<a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>  <span class="keywordflow">if</span> (r == Literal(0))</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>  {</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>    m_computed(start+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, start+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = Literal(0);</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>  }</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>  m_computed(start,start) = r;  </div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>  m_computed(start+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, start) = Literal(0);</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>  m_computed(start+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, start+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = Literal(0);</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>  JacobiRotation&lt;RealScalar&gt; <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>(<a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a>/r,-<a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>/r);</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>  <span class="keywordflow">if</span> (m_compU)  m_naiveU.middleRows(firstCol, <a class="code hl_variable" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>+1).applyOnTheRight(firstCol, firstCol+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>);</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>  <span class="keywordflow">else</span>          m_naiveU.applyOnTheRight(firstCol, firstCol+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>);</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>}<span class="comment">// end deflation 43</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span> </div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span><span class="comment">// page 13</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span><span class="comment">// i,j &gt;= 1, i!=j and |di - dj| &lt; epsilon * norm2(M)</span></div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span><span class="comment">// We apply two rotations to have zj = 0;</span></div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span><span class="comment">// TODO deflation44 is still broken and not properly tested</span></div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::deflation44(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstColu , <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstColm, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstRowW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstColW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> <a class="code hl_variable" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>)</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>{</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>  <span class="keyword">using </span>std::sqrt;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>  <span class="keyword">using </span>std::conj;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>  <span class="keyword">using </span>std::pow;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a> = m_computed(firstColm+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColm);</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> <a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a> = m_computed(firstColm+<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, firstColm);</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> r = <a class="code hl_function" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">sqrt</a>(<a class="code hl_function" href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">numext::abs2</a>(<a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a>) + <a class="code hl_function" href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">numext::abs2</a>(<a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>));</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.4: &quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; <a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1, firstColm)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColm)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1, firstColm) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+2, firstColm) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>  std::cout &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1, firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColm+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1, firstColm+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>    &lt;&lt; m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+2, firstColm+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+2) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>  <span class="keywordflow">if</span> (r==Literal(0))</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>  {</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>    m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = m_computed(firstColm + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, firstColm + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>  }</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>  <a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a>/=r;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>  <a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>/=r;</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>  m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColm) = r;</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>  m_computed(firstColm + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, firstColm + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = m_computed(firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColm + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>  m_computed(firstColm + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, firstColm) = Literal(0);</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span> </div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>  JacobiRotation&lt;RealScalar&gt; <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>(<a class="code hl_variable" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a>,-<a class="code hl_variable" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>  <span class="keywordflow">if</span> (m_compU)  m_naiveU.middleRows(firstColu, <a class="code hl_variable" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>+1).applyOnTheRight(firstColu + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColu + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>  <span class="keywordflow">else</span>          m_naiveU.applyOnTheRight(firstColu+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColu+<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>  <span class="keywordflow">if</span> (m_compV)  m_naiveV.middleRows(firstRowW, <a class="code hl_variable" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>).applyOnTheRight(firstColW + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, firstColW + <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>);</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>}<span class="comment">// end deflation 44</span></div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span> </div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span> </div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span><span class="comment">// acts on block from (firstCol+shift, firstCol+shift) to (lastCol+shift, lastCol+shift) [inclusive]</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span><span class="keywordtype">void</span> BDCSVD&lt;MatrixType&gt;::deflation(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> lastCol, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> k, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstRowW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> firstColW, <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a> shift)</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>{</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>  <span class="keyword">using </span>std::sqrt;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>  <span class="keyword">using </span>std::abs;</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> length = lastCol + 1 - firstCol;</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>  </div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>  Block&lt;MatrixXr,Dynamic,1&gt; col0(m_computed, firstCol+shift, firstCol+shift, length, 1);</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>  Diagonal&lt;MatrixXr&gt; fulldiag(m_computed);</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>  VectorBlock&lt;Diagonal&lt;MatrixXr&gt;,<a class="code hl_variable" href="namespaceEigen.html#ad81fa7195215a0ce30017dfac309f0b2">Dynamic</a>&gt; diag(fulldiag, firstCol+shift, length);</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>  </div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> considerZero = (std::numeric_limits&lt;RealScalar&gt;::min)();</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> maxDiag = diag.tail((std::max)(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a>(1),length-1)).cwiseAbs().maxCoeff();</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> epsilon_strict = numext::maxi&lt;RealScalar&gt;(considerZero,NumTraits&lt;RealScalar&gt;::epsilon() * maxDiag);</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>  <a class="code hl_typedef" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a> epsilon_coarse = Literal(8) * NumTraits&lt;RealScalar&gt;::epsilon() * numext::maxi&lt;RealScalar&gt;(col0.cwiseAbs().maxCoeff(), maxDiag);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>  </div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span> </div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE  </span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\ndeflate:&quot;</span> &lt;&lt; diag.head(k+1).transpose() &lt;&lt; <span class="stringliteral">&quot;  |  &quot;</span> &lt;&lt; diag.segment(k+1,length-k-1).transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>  </div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  <span class="comment">//condition 4.1</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>  <span class="keywordflow">if</span> (diag(0) &lt; epsilon_coarse)</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>  { </div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.1, because &quot;</span> &lt;&lt; diag(0) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; epsilon_coarse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    diag(0) = epsilon_coarse;</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>  }</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span> </div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>  <span class="comment">//condition 4.2</span></div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1;<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;length;++<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(col0(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)) &lt; epsilon_strict)</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>    {</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.2, set z(&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;) to zero because &quot;</span> &lt;&lt; <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(col0(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; epsilon_strict &lt;&lt; <span class="stringliteral">&quot;  (diag(&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>      col0(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = Literal(0);</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>    }</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>  <span class="comment">//condition 4.3</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1;<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;length; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    <span class="keywordflow">if</span> (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; epsilon_coarse)</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    {</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span><span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.3, cancel z(&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; col0(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; because diag(&quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; epsilon_coarse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>      deflation43(firstCol, shift, <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, length);</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    }</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;to be sorted: &quot;</span> &lt;&lt; diag.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;            : &quot;</span> &lt;&lt; col0.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>  {</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    <span class="comment">// Check for total deflation</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>    <span class="comment">// If we have a total deflation, then we have to consider col0(0)==diag(0) as a singular value during sorting</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>    <span class="keywordtype">bool</span> total_deflation = (col0.tail(length-1).array()&lt;considerZero).all();</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    </div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    <span class="comment">// Sort the diagonal entries, since diag(1:k-1) and diag(k:length) are already sorted, let&#39;s do a sorted merge.</span></div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    <span class="comment">// First, compute the respective permutation.</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> *permutation = m_workspaceI.data();</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    {</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>      permutation[0] = 0;</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>      <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 1;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>      </div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>      <span class="comment">// Move deflated diagonal entries at the end.</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>      <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;length; ++<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>        <span class="keywordflow">if</span>(<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))&lt;considerZero)</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>          permutation[<a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++] = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>        </div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1, <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=k+1;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>      <span class="keywordflow">for</span>( ; <a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; length; ++<a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      {</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>             <span class="keywordflow">if</span> (<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; k)             permutation[<a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &gt;= length)       permutation[<a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++;</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; diag(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)) permutation[<a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>        <span class="keywordflow">else</span>                        permutation[<a class="code hl_variable" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>      }</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    }</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>    </div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>    <span class="comment">// If we have a total deflation, then we have to insert diag(0) at the right place</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>    <span class="keywordflow">if</span>(total_deflation)</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>    {</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>      <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;length; ++<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>      {</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>        <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> pi = permutation[<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>        <span class="keywordflow">if</span>(<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(diag(pi))&lt;considerZero || diag(0)&lt;diag(pi))</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>          permutation[<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] = permutation[<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>        {</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>          permutation[<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] = 0;</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>        }</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>      }</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    }</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    </div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    <span class="comment">// Current index of each col, and current column of each index</span></div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> *realInd = m_workspaceI.data()+length;</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> *realCol = m_workspaceI.data()+2*length;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    </div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> pos = 0; pos&lt; length; pos++)</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    {</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>      realCol[pos] = pos;</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>      realInd[pos] = pos;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    }</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>    <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = total_deflation?0:1; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; length; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>    {</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> pi = permutation[length - (total_deflation ? <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1 : <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)];</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a> = realCol[pi];</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>      </div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>      <span class="keyword">using </span>std::swap;</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>      <span class="comment">// swap diagonal and first column entries:</span></div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>      <a class="code hl_function" href="level1__impl_8h.html#a2b21b715d5c8616e8517a1d18923cc73">swap</a>(diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), diag(<a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>));</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>!=0 &amp;&amp; <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>!=0) <a class="code hl_function" href="level1__impl_8h.html#a2b21b715d5c8616e8517a1d18923cc73">swap</a>(col0(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), col0(<a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>));</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span> </div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>      <span class="comment">// change columns</span></div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>      <span class="keywordflow">if</span> (m_compU) m_naiveU.col(firstCol+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).segment(firstCol, length + 1).swap(m_naiveU.col(firstCol+<a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>).segment(firstCol, length + 1));</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>      <span class="keywordflow">else</span>         m_naiveU.col(firstCol+<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).segment(0, 2)                .swap(m_naiveU.col(firstCol+<a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>).segment(0, 2));</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>      <span class="keywordflow">if</span> (m_compV) m_naiveV.col(firstColW + <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).segment(firstRowW, length).swap(m_naiveV.col(firstColW + <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>).segment(firstRowW, length));</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>      <span class="comment">//update real pos</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> realI = realInd[<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>      realCol[realI] = <a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>      realCol[pi] = <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>      realInd[<a class="code hl_variable" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>] = realI;</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>      realInd[<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = pi;</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>    }</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>  }</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;sorted: &quot;</span> &lt;&lt; diag.transpose().format(bdcsvdfmt) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;      : &quot;</span> &lt;&lt; col0.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>    </div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>  <span class="comment">//condition 4.4</span></div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>  {</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    <a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = length-1;</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    <span class="keywordflow">while</span>(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;0 &amp;&amp; (<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))&lt;considerZero || <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(col0(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))&lt;considerZero)) --<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>    <span class="keywordflow">for</span>(; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;1;--<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>       <span class="keywordflow">if</span>( (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) - diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1)) &lt; NumTraits&lt;RealScalar&gt;::epsilon()*maxDiag )</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>      {</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.4 with i = &quot;</span> &lt;&lt; <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; because &quot;</span> &lt;&lt; diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1) &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; (diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) - diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1)) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; NumTraits&lt;RealScalar&gt;::epsilon()*<span class="comment">/*diag(i)*/</span>maxDiag &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>        <a class="code hl_define" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(<a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) - diag(<a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1))&lt;epsilon_coarse &amp;&amp; <span class="stringliteral">&quot; diagonal entries are not properly sorted&quot;</span>);</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>        deflation44(firstCol, firstCol + shift, firstRowW, firstColW, <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1, <a class="code hl_variable" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, length);</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>      }</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>  }</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>  </div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>  <span class="keywordflow">for</span>(<a class="code hl_typedef" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=2;<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;length;++<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>    assert(diag(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>-1)&lt;=diag(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) || <a class="code hl_define" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(diag(<a class="code hl_variable" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))&lt;considerZero);</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>  </div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span><span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>  assert(m_naiveU.allFinite());</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>  assert(m_naiveV.allFinite());</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>  assert(m_computed.allFinite());</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>}<span class="comment">//end deflation</span></div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span> </div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Derived&gt;</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>BDCSVD&lt;typename MatrixBase&lt;Derived&gt;::PlainObject&gt;</div>
<div class="foldopen" id="foldopen01359" data-start="{" data-end="}">
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"><a class="line" href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837"> 1359</a></span><a class="code hl_function" href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837">MatrixBase&lt;Derived&gt;::bdcSvd</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions)<span class="keyword"> const</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;PlainObject&gt;</a>(*<span class="keyword">this</span>, computationOptions);</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>}</div>
</div>
</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span> </div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>} <span class="comment">// end namespace Eigen</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aAngleAxis__mimic__euler_8cpp_html_ab3cd915d758008bd19d0f2428fbb354a"><div class="ttname"><a href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a></div><div class="ttdeci">Matrix3f m</div><div class="ttdef"><b>Definition</b> AngleAxis_mimic_euler.cpp:1</div></div>
<div class="ttc" id="aArray__initializer__list__23__cxx11_8cpp_html_ad2cbe4616e813eb9af81732dca777b24"><div class="ttname"><a href="Array__initializer__list__23__cxx11_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a></div><div class="ttdeci">ArrayXXi a</div><div class="ttdef"><b>Definition</b> Array_initializer_list_23_cxx11.cpp:1</div></div>
<div class="ttc" id="aBiCGSTAB__simple_8cpp_html_a5150192f625f4d7970d61169b9567f39"><div class="ttname"><a href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition</b> BiCGSTAB_simple.cpp:1</div></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aBlockMethods_8h_html_af652402b7c3103c3e9f6c62d51e8d490"><div class="ttname"><a href="BlockMethods_8h.html#af652402b7c3103c3e9f6c62d51e8d490">head</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_STRONG_INLINE FixedSegmentReturnType&lt; internal::get_fixed_value&lt; NType &gt;::value &gt;::Type head(NType n)</div><div class="ttdef"><b>Definition</b> BlockMethods.h:1208</div></div>
<div class="ttc" id="aComplexEigenSolver__compute_8cpp_html_a8a21c18d4aa23228bc1b89f9b12182be"><div class="ttname"><a href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a></div><div class="ttdeci">cout&lt;&lt; &quot;The eigenvalues of A are:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvalues()&lt;&lt; endl;cout&lt;&lt; &quot;The matrix of eigenvectors, V, is:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvectors()&lt;&lt; endl&lt;&lt; endl;complex&lt; float &gt; lambda</div><div class="ttdef"><b>Definition</b> ComplexEigenSolver_compute.cpp:9</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9cb86ff854760bf91a154f2724a9101d"><div class="ttname"><a href="Cwise__array__power__array_8cpp.html#a9cb86ff854760bf91a154f2724a9101d">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aEigenSolver__EigenSolver__MatrixType_8cpp_html_a77c224aa52b434918ce65c33175aa8ad"><div class="ttname"><a href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a></div><div class="ttdeci">MatrixXcd V</div><div class="ttdef"><b>Definition</b> EigenSolver_EigenSolver_MatrixType.cpp:15</div></div>
<div class="ttc" id="aJacobi__makeJacobi_8cpp_html_a4804f9d1c212b9655934738d0ae395ab"><div class="ttname"><a href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; J</div><div class="ttdef"><b>Definition</b> Jacobi_makeJacobi.cpp:3</div></div>
<div class="ttc" id="aMacros_8h_html_a2a07ba221d47a7d636fd13678c8c75b3"><div class="ttname"><a href="Macros_8h.html#a2a07ba221d47a7d636fd13678c8c75b3">EIGEN_SIZE_MIN_PREFER_DYNAMIC</a></div><div class="ttdeci">#define EIGEN_SIZE_MIN_PREFER_DYNAMIC(a, b)</div><div class="ttdef"><b>Definition</b> Macros.h:1294</div></div>
<div class="ttc" id="aMacros_8h_html_a4e742b5a08636a61784c0e173b61e710"><div class="ttname"><a href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a></div><div class="ttdeci">#define eigen_internal_assert(x)</div><div class="ttdef"><b>Definition</b> Macros.h:1043</div></div>
<div class="ttc" id="aMacros_8h_html_acaa7ba89800cfe18d5fd6eed620aea9c"><div class="ttname"><a href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a></div><div class="ttdeci">#define eigen_assert(x)</div><div class="ttdef"><b>Definition</b> Macros.h:1037</div></div>
<div class="ttc" id="aMacros_8h_html_af2d58514e6156c4da2d4af66fafd0b12"><div class="ttname"><a href="Macros_8h.html#af2d58514e6156c4da2d4af66fafd0b12">EIGEN_SIZE_MIN_PREFER_FIXED</a></div><div class="ttdeci">#define EIGEN_SIZE_MIN_PREFER_FIXED(a, b)</div><div class="ttdef"><b>Definition</b> Macros.h:1302</div></div>
<div class="ttc" id="aPartialRedux__count_8cpp_html_acbe60897559b79afc28b79b0687b5f29"><div class="ttname"><a href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a></div><div class="ttdeci">cout&lt;&lt; &quot;Here is the matrix m:&quot;&lt;&lt; endl&lt;&lt; m&lt;&lt; endl;Matrix&lt; ptrdiff_t, 3, 1 &gt; res</div><div class="ttdef"><b>Definition</b> PartialRedux_count.cpp:3</div></div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="aTutorial__commainit__02_8cpp_html_a061459acc9e078fa4699e0e349887215"><div class="ttname"><a href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a></div><div class="ttdeci">int rows</div><div class="ttdef"><b>Definition</b> Tutorial_commainit_02.cpp:1</div></div>
<div class="ttc" id="aTutorial__commainit__02_8cpp_html_a4407a60bc4387adae24cee658711f2d9"><div class="ttname"><a href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a></div><div class="ttdeci">int cols</div><div class="ttdef"><b>Definition</b> Tutorial_commainit_02.cpp:1</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_a41689956983587b085f9da3e48f31d99"><div class="ttname"><a href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a></div><div class="ttdeci">Scalar Scalar * c</div><div class="ttdef"><b>Definition</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_a846c9667e34d56c560bb7f0ac6e173f6"><div class="ttname"><a href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_acc017e1f28bf1b83809251a830f315c3"><div class="ttname"><a href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a></div><div class="ttdeci">Scalar Scalar int size</div><div class="ttdef"><b>Definition</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="abench__gemm_8cpp_html_acb5c3dc237f99cf17167e8a629f01b43"><div class="ttname"><a href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a></div><div class="ttdeci">NumTraits&lt; Scalar &gt;::Real RealScalar</div><div class="ttdef"><b>Definition</b> bench_gemm.cpp:47</div></div>
<div class="ttc" id="abench__gemm_8cpp_html_addc86e8508f14411ec98f521c520f875"><div class="ttname"><a href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a></div><div class="ttdeci">Matrix&lt; SCALARA, Dynamic, Dynamic, opt_A &gt; A</div><div class="ttdef"><b>Definition</b> bench_gemm.cpp:48</div></div>
<div class="ttc" id="abench__gemm_8cpp_html_af60dc8214a22d8dfced07a33ec8e902d"><div class="ttname"><a href="bench__gemm_8cpp.html#af60dc8214a22d8dfced07a33ec8e902d">B</a></div><div class="ttdeci">Matrix&lt; SCALARB, Dynamic, Dynamic, opt_B &gt; B</div><div class="ttdef"><b>Definition</b> bench_gemm.cpp:49</div></div>
<div class="ttc" id="abenchmark-blocking-sizes_8cpp_html_af5fcaa2ea9f565466ca96c2992ea0771"><div class="ttname"><a href="benchmark-blocking-sizes_8cpp.html#af5fcaa2ea9f565466ca96c2992ea0771">MatrixType</a></div><div class="ttdeci">MatrixXf MatrixType</div><div class="ttdef"><b>Definition</b> benchmark-blocking-sizes.cpp:52</div></div>
<div class="ttc" id="aclassEigen_1_1Array_html"><div class="ttname"><a href="classEigen_1_1Array.html">Eigen::Array</a></div><div class="ttdoc">General-purpose arrays with easy API for coefficient-wise operations.</div><div class="ttdef"><b>Definition</b> Array.h:47</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html"><div class="ttname"><a href="classEigen_1_1BDCSVD.html">Eigen::BDCSVD</a></div><div class="ttdoc">class Bidiagonal Divide and Conquer SVD</div><div class="ttdef"><b>Definition</b> BDCSVD.h:74</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a01ac6b6ddf81569780bf6449e8484a6c"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a01ac6b6ddf81569780bf6449e8484a6c">Eigen::BDCSVD::m_isTranspose</a></div><div class="ttdeci">bool m_isTranspose</div><div class="ttdef"><b>Definition</b> BDCSVD.h:201</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a083d99e05949bab974bbff2966606b7f"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a083d99e05949bab974bbff2966606b7f">Eigen::BDCSVD::cols</a></div><div class="ttdeci">Index cols() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:213</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a0ea2c57bf088d5fc480ad81945157079"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a0ea2c57bf088d5fc480ad81945157079">Eigen::BDCSVD::VectorType</a></div><div class="ttdeci">Matrix&lt; RealScalar, Dynamic, 1 &gt; VectorType</div><div class="ttdef"><b>Definition</b> BDCSVD.h:103</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a1a1140cddb7727637b5e33d9f3b13299"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1a1140cddb7727637b5e33d9f3b13299">Eigen::BDCSVD::MatrixVType</a></div><div class="ttdeci">Base::MatrixVType MatrixVType</div><div class="ttdef"><b>Definition</b> BDCSVD.h:98</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a1b429d828258ec58c1fc4ced6213d64d"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1b429d828258ec58c1fc4ced6213d64d">Eigen::BDCSVD::RealScalar</a></div><div class="ttdeci">NumTraits&lt; typenameMatrixType::Scalar &gt;::Real RealScalar</div><div class="ttdef"><b>Definition</b> BDCSVD.h:85</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a1e07b25c4a606cee8f34cdc75189a3b8"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">Eigen::BDCSVD::m_algoswap</a></div><div class="ttdeci">int m_algoswap</div><div class="ttdef"><b>Definition</b> BDCSVD.h:200</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a1e177918a1acf8153ff5f323fbeed9fe"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1e177918a1acf8153ff5f323fbeed9fe">Eigen::BDCSVD::ArrayXr</a></div><div class="ttdeci">Array&lt; RealScalar, Dynamic, 1 &gt; ArrayXr</div><div class="ttdef"><b>Definition</b> BDCSVD.h:104</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081a0d30a3a19367ab871e64a980aea219f0"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a0d30a3a19367ab871e64a980aea219f0">Eigen::BDCSVD::MaxColsAtCompileTime</a></div><div class="ttdeci">@ MaxColsAtCompileTime</div><div class="ttdef"><b>Definition</b> BDCSVD.h:92</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081a135cfd5fd712f17e50bdc0efa61cc366"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a135cfd5fd712f17e50bdc0efa61cc366">Eigen::BDCSVD::DiagSizeAtCompileTime</a></div><div class="ttdeci">@ DiagSizeAtCompileTime</div><div class="ttdef"><b>Definition</b> BDCSVD.h:90</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081a75ab90cba2fd1bdc327e07d349be1fd9"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081a75ab90cba2fd1bdc327e07d349be1fd9">Eigen::BDCSVD::MaxRowsAtCompileTime</a></div><div class="ttdeci">@ MaxRowsAtCompileTime</div><div class="ttdef"><b>Definition</b> BDCSVD.h:91</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081aa0222fb3be5089e2f7ca67e1e2882954"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aa0222fb3be5089e2f7ca67e1e2882954">Eigen::BDCSVD::RowsAtCompileTime</a></div><div class="ttdeci">@ RowsAtCompileTime</div><div class="ttdef"><b>Definition</b> BDCSVD.h:88</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081aaac5b9fa1cd1464ae3ec6ffa7b86a95d"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081aaac5b9fa1cd1464ae3ec6ffa7b86a95d">Eigen::BDCSVD::MatrixOptions</a></div><div class="ttdeci">@ MatrixOptions</div><div class="ttdef"><b>Definition</b> BDCSVD.h:94</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081ab37c73c7ace3196b7a9b799a33492116"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081ab37c73c7ace3196b7a9b799a33492116">Eigen::BDCSVD::MaxDiagSizeAtCompileTime</a></div><div class="ttdeci">@ MaxDiagSizeAtCompileTime</div><div class="ttdef"><b>Definition</b> BDCSVD.h:93</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a2f2b7e6a53b0aaa8d82b701f15d4c081af0a020e5fd77a8f6f2cfb7145c8da295"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2f2b7e6a53b0aaa8d82b701f15d4c081af0a020e5fd77a8f6f2cfb7145c8da295">Eigen::BDCSVD::ColsAtCompileTime</a></div><div class="ttdeci">@ ColsAtCompileTime</div><div class="ttdef"><b>Definition</b> BDCSVD.h:89</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a302746d9c534cd513c1df87c7ae4850d"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a302746d9c534cd513c1df87c7ae4850d">Eigen::BDCSVD::BDCSVD</a></div><div class="ttdeci">BDCSVD(const MatrixType &amp;matrix, unsigned int computationOptions=0)</div><div class="ttdoc">Constructor performing the decomposition of given matrix.</div><div class="ttdef"><b>Definition</b> BDCSVD.h:140</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a39514816d38f9c418cf3f3514b511c2c"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a39514816d38f9c418cf3f3514b511c2c">Eigen::BDCSVD::BDCSVD</a></div><div class="ttdeci">BDCSVD()</div><div class="ttdoc">Default Constructor.</div><div class="ttdef"><b>Definition</b> BDCSVD.h:114</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a3e1fa48b3d042b7daf7392724a68bb60"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a3e1fa48b3d042b7daf7392724a68bb60">Eigen::BDCSVD::BDCSVD</a></div><div class="ttdeci">BDCSVD(Index rows, Index cols, unsigned int computationOptions=0)</div><div class="ttdoc">Default Constructor with memory preallocation.</div><div class="ttdef"><b>Definition</b> BDCSVD.h:124</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a43bb7c5a142ebde4c38967c5c3d42910"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a43bb7c5a142ebde4c38967c5c3d42910">Eigen::BDCSVD::m_nRec</a></div><div class="ttdeci">Index m_nRec</div><div class="ttdef"><b>Definition</b> BDCSVD.h:197</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a44cd685aa8d3807c006f6557bd69abf8"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a44cd685aa8d3807c006f6557bd69abf8">Eigen::BDCSVD::SingularValuesType</a></div><div class="ttdeci">Base::SingularValuesType SingularValuesType</div><div class="ttdef"><b>Definition</b> BDCSVD.h:99</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a4c38005126c75b1ba3b1b95117b4546d"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a4c38005126c75b1ba3b1b95117b4546d">Eigen::BDCSVD::MatrixUType</a></div><div class="ttdeci">Base::MatrixUType MatrixUType</div><div class="ttdef"><b>Definition</b> BDCSVD.h:97</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a52e3c627775010775c64d16a00cdb770"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">Eigen::BDCSVD::compute</a></div><div class="ttdeci">BDCSVD &amp; compute(const MatrixType &amp;matrix, unsigned int computationOptions)</div><div class="ttdoc">Method performing the decomposition of given matrix using custom options.</div><div class="ttdef"><b>Definition</b> BDCSVD.h:245</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a61880a5f6dbf7a14f91be80eaa3a22bc"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a61880a5f6dbf7a14f91be80eaa3a22bc">Eigen::BDCSVD::compute</a></div><div class="ttdeci">BDCSVD &amp; compute(const MatrixType &amp;matrix)</div><div class="ttdoc">Method performing the decomposition of given matrix using current options.</div><div class="ttdef"><b>Definition</b> BDCSVD.h:168</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a63dc95af59e08a68b11268e98feea7fa"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a63dc95af59e08a68b11268e98feea7fa">Eigen::BDCSVD::m_compU</a></div><div class="ttdeci">bool m_compU</div><div class="ttdef"><b>Definition</b> BDCSVD.h:201</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a707ea2d37a7024a6317f001a6971fbec"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a707ea2d37a7024a6317f001a6971fbec">Eigen::BDCSVD::m_compV</a></div><div class="ttdeci">bool m_compV</div><div class="ttdef"><b>Definition</b> BDCSVD.h:201</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a76dcaed5bc2dd1c37832805fa8fed943"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a76dcaed5bc2dd1c37832805fa8fed943">Eigen::BDCSVD::m_computed</a></div><div class="ttdeci">MatrixXr m_computed</div><div class="ttdef"><b>Definition</b> BDCSVD.h:196</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a7b32c2adca9f10283820f437f08f6271"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">Eigen::BDCSVD::MatrixXr</a></div><div class="ttdeci">Matrix&lt; RealScalar, Dynamic, Dynamic, ColMajor &gt; MatrixXr</div><div class="ttdef"><b>Definition</b> BDCSVD.h:102</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a857bb0e5f633e0600ea6861f14da8a1b"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a857bb0e5f633e0600ea6861f14da8a1b">Eigen::BDCSVD::m_naiveU</a></div><div class="ttdeci">MatrixXr m_naiveU</div><div class="ttdef"><b>Definition</b> BDCSVD.h:195</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a8bfc4be4bdc669038298ea29b940532f"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a8bfc4be4bdc669038298ea29b940532f">Eigen::BDCSVD::m_workspaceI</a></div><div class="ttdeci">ArrayXi m_workspaceI</div><div class="ttdef"><b>Definition</b> BDCSVD.h:199</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a8c3310eee662af4ca2428f7afd1472ed"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">Eigen::BDCSVD::MatrixType</a></div><div class="ttdeci">_MatrixType MatrixType</div><div class="ttdef"><b>Definition</b> BDCSVD.h:83</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a94b71ee8ecf0b6b621a1267cf136adc9"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a94b71ee8ecf0b6b621a1267cf136adc9">Eigen::BDCSVD::m_naiveV</a></div><div class="ttdeci">MatrixXr m_naiveV</div><div class="ttdef"><b>Definition</b> BDCSVD.h:195</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_a9dea0e28217993ad7de85351357724a7"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a9dea0e28217993ad7de85351357724a7">Eigen::BDCSVD::ArrayXi</a></div><div class="ttdeci">Array&lt; Index, 1, Dynamic &gt; ArrayXi</div><div class="ttdef"><b>Definition</b> BDCSVD.h:105</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_aa21c0cc5e99c861970bae45d94cae9ad"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aa21c0cc5e99c861970bae45d94cae9ad">Eigen::BDCSVD::setSwitchSize</a></div><div class="ttdeci">void setSwitchSize(int s)</div><div class="ttdef"><b>Definition</b> BDCSVD.h:173</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_aab1c377c616062cc85356e47312cb412"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">Eigen::BDCSVD::IndicesRef</a></div><div class="ttdeci">Ref&lt; ArrayXi &gt; IndicesRef</div><div class="ttdef"><b>Definition</b> BDCSVD.h:107</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_aad17038f9628ce5ed6e1461a67cd3a03"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Eigen::BDCSVD::Literal</a></div><div class="ttdeci">NumTraits&lt; RealScalar &gt;::Literal Literal</div><div class="ttdef"><b>Definition</b> BDCSVD.h:86</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_aaeab2cfc3f87e2a2c595a9d5b4d97c71"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aaeab2cfc3f87e2a2c595a9d5b4d97c71">Eigen::BDCSVD::Scalar</a></div><div class="ttdeci">MatrixType::Scalar Scalar</div><div class="ttdef"><b>Definition</b> BDCSVD.h:84</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_ab1a0d1fcc818a876c3cb2b32887604be"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ab1a0d1fcc818a876c3cb2b32887604be">Eigen::BDCSVD::rows</a></div><div class="ttdeci">Index rows() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:212</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_abdf2b178ad413766bc1b292fcef701e2"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#abdf2b178ad413766bc1b292fcef701e2">Eigen::BDCSVD::~BDCSVD</a></div><div class="ttdeci">~BDCSVD()</div><div class="ttdef"><b>Definition</b> BDCSVD.h:146</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_acf9211e5353d60fc3209d62fa0e2bdf7"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#acf9211e5353d60fc3209d62fa0e2bdf7">Eigen::BDCSVD::MatrixX</a></div><div class="ttdeci">Matrix&lt; Scalar, Dynamic, Dynamic, ColMajor &gt; MatrixX</div><div class="ttdef"><b>Definition</b> BDCSVD.h:101</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_ad30a7a883b86028c45559593c7a678a2"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">Eigen::BDCSVD::ArrayRef</a></div><div class="ttdeci">Ref&lt; ArrayXr &gt; ArrayRef</div><div class="ttdef"><b>Definition</b> BDCSVD.h:106</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_ad62998546febd86ba715a9eae4c47b4b"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ad62998546febd86ba715a9eae4c47b4b">Eigen::BDCSVD::m_workspace</a></div><div class="ttdeci">ArrayXr m_workspace</div><div class="ttdef"><b>Definition</b> BDCSVD.h:198</div></div>
<div class="ttc" id="aclassEigen_1_1BDCSVD_html_ade7ebb87b1735432218681831b1801cc"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">Eigen::BDCSVD::m_numIters</a></div><div class="ttdeci">int m_numIters</div><div class="ttdef"><b>Definition</b> BDCSVD.h:216</div></div>
<div class="ttc" id="aclassEigen_1_1Block_html"><div class="ttname"><a href="classEigen_1_1Block.html">Eigen::Block</a></div><div class="ttdoc">Expression of a fixed-size or dynamic-size block.</div><div class="ttdef"><b>Definition</b> Block.h:105</div></div>
<div class="ttc" id="aclassEigen_1_1JacobiSVD_html"><div class="ttname"><a href="classEigen_1_1JacobiSVD.html">Eigen::JacobiSVD</a></div><div class="ttdoc">Two-sided Jacobi SVD decomposition of a rectangular matrix.</div><div class="ttdef"><b>Definition</b> JacobiSVD.h:490</div></div>
<div class="ttc" id="aclassEigen_1_1MatrixBase_html_ae171b74b5d530846ee0836135ffcf837"><div class="ttname"><a href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837">Eigen::MatrixBase::bdcSvd</a></div><div class="ttdeci">BDCSVD&lt; PlainObject &gt; bdcSvd(unsigned int computationOptions=0) const</div><div class="ttdef"><b>Definition</b> BDCSVD.h:1359</div></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, RowsAtCompileTime, RowsAtCompileTime, MatrixOptions, MaxRowsAtCompileTime, MaxRowsAtCompileTime &gt;</a></div></div>
<div class="ttc" id="aclassEigen_1_1Ref_html"><div class="ttname"><a href="classEigen_1_1Ref.html">Eigen::Ref</a></div><div class="ttdoc">A matrix or vector expression mapping an existing expression.</div><div class="ttdef"><b>Definition</b> Ref.h:283</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html"><div class="ttname"><a href="classEigen_1_1SVDBase.html">Eigen::SVDBase</a></div><div class="ttdoc">Base class of SVD algorithms.</div><div class="ttdef"><b>Definition</b> SVDBase.h:64</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a083d99e05949bab974bbff2966606b7f"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a083d99e05949bab974bbff2966606b7f">Eigen::SVDBase::cols</a></div><div class="ttdeci">Index cols() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:213</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a1eec8ead08bc9cd1729ba9ba7beb6b41"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a1eec8ead08bc9cd1729ba9ba7beb6b41">Eigen::SVDBase::m_computeFullV</a></div><div class="ttdeci">bool m_computeFullV</div><div class="ttdef"><b>Definition</b> SVDBase.h:278</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a447d2789c6fda585482933f9f0cd02af"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a447d2789c6fda585482933f9f0cd02af">Eigen::SVDBase::m_info</a></div><div class="ttdeci">ComputationInfo m_info</div><div class="ttdef"><b>Definition</b> SVDBase.h:275</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a47b67c55d69ba645bb7ae32bb5466138"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a47b67c55d69ba645bb7ae32bb5466138">Eigen::SVDBase::m_computeThinU</a></div><div class="ttdeci">bool m_computeThinU</div><div class="ttdef"><b>Definition</b> SVDBase.h:277</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a569913a15fa2f327121f155682368602"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a569913a15fa2f327121f155682368602">Eigen::SVDBase::info</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC ComputationInfo info() const</div><div class="ttdoc">Reports whether previous computation was successful.</div><div class="ttdef"><b>Definition</b> SVDBase.h:236</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a5f12efcb791eb007d4a4890ac5255ac4"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a5f12efcb791eb007d4a4890ac5255ac4">Eigen::SVDBase::computeV</a></div><div class="ttdeci">bool computeV() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:210</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a6229a37997eca1072b52cca5ee7a2bec"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a6229a37997eca1072b52cca5ee7a2bec">Eigen::SVDBase&lt; BDCSVD&lt; _MatrixType &gt; &gt;::Index</a></div><div class="ttdeci">Eigen::Index Index</div><div class="ttdef"><b>Definition</b> SVDBase.h:74</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a633b92f4eb9c65911b943b93bb8b341c"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a633b92f4eb9c65911b943b93bb8b341c">Eigen::SVDBase::m_isInitialized</a></div><div class="ttdeci">bool m_isInitialized</div><div class="ttdef"><b>Definition</b> SVDBase.h:276</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a680646d2f3fa0de030cbf9b4815d6cda"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a680646d2f3fa0de030cbf9b4815d6cda">Eigen::SVDBase&lt; BDCSVD&lt; _MatrixType &gt; &gt;::m_computationOptions</a></div><div class="ttdeci">unsigned int m_computationOptions</div><div class="ttdef"><b>Definition</b> SVDBase.h:279</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a69cf1cfb527ff5562156c13bdca45ca5"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a69cf1cfb527ff5562156c13bdca45ca5">Eigen::SVDBase::m_matrixV</a></div><div class="ttdeci">MatrixVType m_matrixV</div><div class="ttdef"><b>Definition</b> SVDBase.h:273</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a6eca3829eb56684ca01c291c6630c8d8"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a6eca3829eb56684ca01c291c6630c8d8">Eigen::SVDBase::m_diagSize</a></div><div class="ttdeci">Index m_diagSize</div><div class="ttdef"><b>Definition</b> SVDBase.h:280</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_a705a7c2709e1624ccc19aa748a78d473"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a705a7c2709e1624ccc19aa748a78d473">Eigen::SVDBase::computeU</a></div><div class="ttdeci">bool computeU() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:208</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_aa41b395662650f2e10652f76365877c4"><div class="ttname"><a href="classEigen_1_1SVDBase.html#aa41b395662650f2e10652f76365877c4">Eigen::SVDBase::m_nonzeroSingularValues</a></div><div class="ttdeci">Index m_nonzeroSingularValues</div><div class="ttdef"><b>Definition</b> SVDBase.h:280</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_ab1a0d1fcc818a876c3cb2b32887604be"><div class="ttname"><a href="classEigen_1_1SVDBase.html#ab1a0d1fcc818a876c3cb2b32887604be">Eigen::SVDBase::rows</a></div><div class="ttdeci">Index rows() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:212</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_ab71e31e61c33f68ff2f499ed9f30e718"><div class="ttname"><a href="classEigen_1_1SVDBase.html#ab71e31e61c33f68ff2f499ed9f30e718">Eigen::SVDBase::m_singularValues</a></div><div class="ttdeci">SingularValuesType m_singularValues</div><div class="ttdef"><b>Definition</b> SVDBase.h:274</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_ac44c307a70731003003faf3a9bdf14f6"><div class="ttname"><a href="classEigen_1_1SVDBase.html#ac44c307a70731003003faf3a9bdf14f6">Eigen::SVDBase::singularValues</a></div><div class="ttdeci">const SingularValuesType &amp; singularValues() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:129</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_ac8321ff2cbf3b82f5c2638b9de6661af"><div class="ttname"><a href="classEigen_1_1SVDBase.html#ac8321ff2cbf3b82f5c2638b9de6661af">Eigen::SVDBase::m_computeThinV</a></div><div class="ttdeci">bool m_computeThinV</div><div class="ttdef"><b>Definition</b> SVDBase.h:278</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_accbc8e3f9baab3a57a6eba8e4cc3ea27"><div class="ttname"><a href="classEigen_1_1SVDBase.html#accbc8e3f9baab3a57a6eba8e4cc3ea27">Eigen::SVDBase::matrixU</a></div><div class="ttdeci">const MatrixUType &amp; matrixU() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:101</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_ad6f49fd8f826a41109f8eb68e2f48dc4"><div class="ttname"><a href="classEigen_1_1SVDBase.html#ad6f49fd8f826a41109f8eb68e2f48dc4">Eigen::SVDBase::m_computeFullU</a></div><div class="ttdeci">bool m_computeFullU</div><div class="ttdef"><b>Definition</b> SVDBase.h:277</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_af09f06357d7d7442f7ca7343713756fe"><div class="ttname"><a href="classEigen_1_1SVDBase.html#af09f06357d7d7442f7ca7343713756fe">Eigen::SVDBase::matrixV</a></div><div class="ttdeci">const MatrixVType &amp; matrixV() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:117</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_af0e0b3833c1d49286c0fdcbc023c3bd8"><div class="ttname"><a href="classEigen_1_1SVDBase.html#af0e0b3833c1d49286c0fdcbc023c3bd8">Eigen::SVDBase::m_matrixU</a></div><div class="ttdeci">MatrixUType m_matrixU</div><div class="ttdef"><b>Definition</b> SVDBase.h:272</div></div>
<div class="ttc" id="aclassEigen_1_1SVDBase_html_afe8a555f38393a319a71ec0f0331c9ef"><div class="ttname"><a href="classEigen_1_1SVDBase.html#afe8a555f38393a319a71ec0f0331c9ef">Eigen::SVDBase::nonzeroSingularValues</a></div><div class="ttdeci">Index nonzeroSingularValues() const</div><div class="ttdef"><b>Definition</b> SVDBase.h:136</div></div>
<div class="ttc" id="aclassEigen_1_1Triplet_html"><div class="ttname"><a href="classEigen_1_1Triplet.html">Eigen::Triplet&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassEigen_1_1internal_1_1TensorLazyEvaluatorWritable_html"><div class="ttname"><a href="classEigen_1_1internal_1_1TensorLazyEvaluatorWritable.html">Eigen::internal::TensorLazyEvaluatorWritable</a></div><div class="ttdef"><b>Definition</b> TensorRef.h:81</div></div>
<div class="ttc" id="acommon_8h_html_a2c4e93d1f3604b217c5d0e211def96fb"><div class="ttname"><a href="common_8h.html#a2c4e93d1f3604b217c5d0e211def96fb">matrix</a></div><div class="ttdeci">Map&lt; Matrix&lt; T, Dynamic, Dynamic, ColMajor &gt;, 0, OuterStride&lt;&gt; &gt; matrix(T *data, int rows, int cols, int stride)</div><div class="ttdef"><b>Definition</b> common.h:110</div></div>
<div class="ttc" id="adatatypes_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition</b> datatypes.h:17</div></div>
<div class="ttc" id="agnuplot__common__settings_8hh_html_a028be1055fb10c679b6153f8dcd0befa"><div class="ttname"><a href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a></div><div class="ttdeci">set noclip points set clip one set noclip two set bar set border lt lw set xdata set ydata set zdata set x2data set y2data set boxwidth set dummy y set format x g set format y g set format x2 g set format y2 g set format z g set angles radians set nogrid set key title set key left top Right noreverse box linetype linewidth samplen spacing width set nolabel set noarrow set nologscale set logscale x set set pointsize set encoding default set nopolar set noparametric set set set set surface set nocontour set clabel set mapping cartesian set nohidden3d set cntrparam order set cntrparam linear set cntrparam levels auto set cntrparam points set size set set xzeroaxis lt lw set x2zeroaxis lt lw set yzeroaxis lt lw set y2zeroaxis lt lw set tics in set ticslevel set tics scale</div><div class="ttdef"><b>Definition</b> gnuplot_common_settings.hh:54</div></div>
<div class="ttc" id="agnuplot__common__settings_8hh_html_a5fd331c99e778f04762be6d8173eb4d2"><div class="ttname"><a href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a></div><div class="ttdeci">set noclip points set clip one set noclip two set bar set border lt lw set xdata set ydata set zdata set x2data set y2data set boxwidth set dummy x</div><div class="ttdef"><b>Definition</b> gnuplot_common_settings.hh:12</div></div>
<div class="ttc" id="agroup__enums_html_gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8"><div class="ttname"><a href="group__enums.html#gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8">Eigen::Aligned</a></div><div class="ttdeci">@ Aligned</div><div class="ttdef"><b>Definition</b> Constants.h:240</div></div>
<div class="ttc" id="agroup__enums_html_gga85fad7b87587764e5cf6b513a9e0ee5ea580b2a3cafe585691e789f768fb729bf"><div class="ttname"><a href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea580b2a3cafe585691e789f768fb729bf">Eigen::InvalidInput</a></div><div class="ttdeci">@ InvalidInput</div><div class="ttdef"><b>Definition</b> Constants.h:449</div></div>
<div class="ttc" id="agroup__enums_html_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf"><div class="ttname"><a href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf">Eigen::Success</a></div><div class="ttdeci">@ Success</div><div class="ttdef"><b>Definition</b> Constants.h:442</div></div>
<div class="ttc" id="agroup__enums_html_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57"><div class="ttname"><a href="group__enums.html#gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57">Eigen::NoConvergence</a></div><div class="ttdeci">@ NoConvergence</div><div class="ttdef"><b>Definition</b> Constants.h:446</div></div>
<div class="ttc" id="agroup__enums_html_ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930"><div class="ttname"><a href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930">Eigen::ComputeFullV</a></div><div class="ttdeci">@ ComputeFullV</div><div class="ttdef"><b>Definition</b> Constants.h:397</div></div>
<div class="ttc" id="agroup__enums_html_ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f"><div class="ttname"><a href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f">Eigen::ComputeFullU</a></div><div class="ttdeci">@ ComputeFullU</div><div class="ttdef"><b>Definition</b> Constants.h:393</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition</b> level1_cplx_impl.h:126</div></div>
<div class="ttc" id="alevel1__impl_8h_html_a2b21b715d5c8616e8517a1d18923cc73"><div class="ttname"><a href="level1__impl_8h.html#a2b21b715d5c8616e8517a1d18923cc73">swap</a></div><div class="ttdeci">int EIGEN_BLAS_FUNC() swap(int *n, RealScalar *px, int *incx, RealScalar *py, int *incy)</div><div class="ttdef"><b>Definition</b> level1_impl.h:130</div></div>
<div class="ttc" id="alevel1__impl_8h_html_aabd32585d834ced5249f811b38025e9d"><div class="ttname"><a href="level1__impl_8h.html#aabd32585d834ced5249f811b38025e9d">copy</a></div><div class="ttdeci">int EIGEN_BLAS_FUNC() copy(int *n, RealScalar *px, int *incx, RealScalar *py, int *incy)</div><div class="ttdef"><b>Definition</b> level1_impl.h:29</div></div>
<div class="ttc" id="anamespaceEigen_1_1bfloat16__impl_html_ab03218ad82a11c00ab667d0fe2c345cf"><div class="ttname"><a href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">Eigen::bfloat16_impl::sqrt</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC bfloat16 sqrt(const bfloat16 &amp;a)</div><div class="ttdef"><b>Definition</b> BFloat16.h:511</div></div>
<div class="ttc" id="anamespaceEigen_1_1numext_html_a279a4447a10bf7c9b725136986d80955"><div class="ttname"><a href="namespaceEigen_1_1numext.html#a279a4447a10bf7c9b725136986d80955">Eigen::numext::isfinite</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_ALWAYS_INLINE bool() isfinite(const Eigen::bfloat16 &amp;h)</div><div class="ttdef"><b>Definition</b> BFloat16.h:671</div></div>
<div class="ttc" id="anamespaceEigen_1_1numext_html_ac09cd9261a50a46dd4937868020c7c45"><div class="ttname"><a href="namespaceEigen_1_1numext.html#ac09cd9261a50a46dd4937868020c7c45">Eigen::numext::abs</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_ALWAYS_INLINE internal::enable_if&lt; NumTraits&lt; T &gt;::IsSigned||NumTraits&lt; T &gt;::IsComplex, typenameNumTraits&lt; T &gt;::Real &gt;::type abs(const T &amp;x)</div><div class="ttdef"><b>Definition</b> MathFunctions.h:1509</div></div>
<div class="ttc" id="anamespaceEigen_1_1numext_html_ad59216129a430099e97b4c4b1e2f2984"><div class="ttname"><a href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">Eigen::numext::abs2</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC bool abs2(bool x)</div><div class="ttdef"><b>Definition</b> MathFunctions.h:1292</div></div>
<div class="ttc" id="anamespaceEigen_html"><div class="ttname"><a href="namespaceEigen.html">Eigen</a></div><div class="ttdoc">Namespace containing all symbols from the Eigen library.</div><div class="ttdef"><b>Definition</b> bench_norm.cpp:85</div></div>
<div class="ttc" id="anamespaceEigen_html_a62e77e0933482dafde8fe197d9a2cfde"><div class="ttname"><a href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a></div><div class="ttdeci">EIGEN_DEFAULT_DENSE_INDEX_TYPE Index</div><div class="ttdoc">The Index type as used for the API.</div><div class="ttdef"><b>Definition</b> Meta.h:74</div></div>
<div class="ttc" id="anamespaceEigen_html_a6dd0fb5de9a0e3196003928a28bb151b"><div class="ttname"><a href="namespaceEigen.html#a6dd0fb5de9a0e3196003928a28bb151b">Eigen::prod</a></div><div class="ttdeci">const Product&lt; Lhs, Rhs &gt; prod(const Lhs &amp;lhs, const Rhs &amp;rhs)</div><div class="ttdef"><b>Definition</b> evaluators.cpp:8</div></div>
<div class="ttc" id="anamespaceEigen_html_ad81fa7195215a0ce30017dfac309f0b2"><div class="ttname"><a href="namespaceEigen.html#ad81fa7195215a0ce30017dfac309f0b2">Eigen::Dynamic</a></div><div class="ttdeci">const int Dynamic</div><div class="ttdef"><b>Definition</b> Constants.h:22</div></div>
<div class="ttc" id="anamespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition</b> BandTriangularSolver.h:13</div></div>
<div class="ttc" id="aref__serial_8h_html_a20302e2c99a60d3f612dba57e3f6333b"><div class="ttname"><a href="ref__serial_8h.html#a20302e2c99a60d3f612dba57e3f6333b">count</a></div><div class="ttdeci">uint8_t count</div><div class="ttdef"><b>Definition</b> ref_serial.h:256</div></div>
<div class="ttc" id="astructEigen_1_1EigenBase_html_a9f40726259520d7e9c5ce58d19d62e79"><div class="ttname"><a href="structEigen_1_1EigenBase.html#a9f40726259520d7e9c5ce58d19d62e79">Eigen::EigenBase::size</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_CONSTEXPR Index size() const EIGEN_NOEXCEPT</div><div class="ttdef"><b>Definition</b> EigenBase.h:67</div></div>
<div class="ttc" id="astructEigen_1_1NumTraits_html"><div class="ttname"><a href="structEigen_1_1NumTraits.html">Eigen::NumTraits</a></div><div class="ttdoc">Holds information about the various numeric (i.e. scalar) types allowed by Eigen.</div><div class="ttdef"><b>Definition</b> NumTraits.h:233</div></div>
<div class="ttc" id="astructEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4_html_afd85342058bafd2b0fd201db71b54f50"><div class="ttname"><a href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html#afd85342058bafd2b0fd201db71b54f50">Eigen::internal::traits&lt; BDCSVD&lt; _MatrixType &gt; &gt;::MatrixType</a></div><div class="ttdeci">_MatrixType MatrixType</div><div class="ttdef"><b>Definition</b> BDCSVD.h:44</div></div>
<div class="ttc" id="astructEigen_1_1internal_1_1traits_html"><div class="ttname"><a href="structEigen_1_1internal_1_1traits.html">Eigen::internal::traits</a></div><div class="ttdef"><b>Definition</b> ForwardDeclarations.h:17</div></div>
<div class="ttc" id="astructVectorType_html"><div class="ttname"><a href="structVectorType.html">VectorType</a></div><div class="ttdef"><b>Definition</b> FFTW.cpp:65</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
