<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TR-mbed: core/util/algorithms/eigen-3.4.0/unsupported/Eigen/src/NonLinearOptimization/HybridNonLinearSolver.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TR-mbed
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_459a7c9a427a2877b0db19c6b8d6e89d.html">util</a></li><li class="navelem"><a class="el" href="dir_2b91f87ecc8d5a52d8144fa162b6316d.html">algorithms</a></li><li class="navelem"><a class="el" href="dir_d26f9082d1b630c8fa4b82ce9b6be008.html">eigen-3.4.0</a></li><li class="navelem"><a class="el" href="dir_01abaef4fdd2408adb791b0d217b0c79.html">unsupported</a></li><li class="navelem"><a class="el" href="dir_9ff4d1aa5b19debad00b4f551d280be0.html">Eigen</a></li><li class="navelem"><a class="el" href="dir_396daa4cb68d5f7a1d87a41edebb417a.html">src</a></li><li class="navelem"><a class="el" href="dir_cb18e81023b0201239f88fae3012ffb0.html">NonLinearOptimization</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HybridNonLinearSolver.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="HybridNonLinearSolver_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -*- coding: utf-8</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// vim: set fileencoding=utf-8</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// This file is part of Eigen, a lightweight C++ template library</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// for linear algebra.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Copyright (C) 2009 Thomas Capricelli &lt;orzel@freehackers.org&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This Source Code Form is subject to the terms of the Mozilla</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Public License v. 2.0. If a copy of the MPL was not distributed</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifndef EIGEN_HYBRIDNONLINEARSOLVER_H</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#define EIGEN_HYBRIDNONLINEARSOLVER_H</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceEigen.html">Eigen</a> { </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html">   18</a></span>&#160;<span class="keyword">namespace </span>HybridNonLinearSolverSpace { </div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">   19</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">Status</a> {</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">   20</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">Running</a> = -1,</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">   21</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">ImproperInputParameters</a> = 0,</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689ad5adf33a2f4813fe8a1aa1e9f70e9961">   22</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689ad5adf33a2f4813fe8a1aa1e9f70e9961">RelativeErrorTooSmall</a> = 1,</div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a82b971eb0bd71b87dacdf4cd3de8672d">   23</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a82b971eb0bd71b87dacdf4cd3de8672d">TooManyFunctionEvaluation</a> = 2,</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a4ea5d3da0d16abee53bc5ddafdcc65e6">   24</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a4ea5d3da0d16abee53bc5ddafdcc65e6">TolTooSmall</a> = 3,</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a9dbd584a67d1457dfe95311188ac631e">   25</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a9dbd584a67d1457dfe95311188ac631e">NotMakingProgressJacobian</a> = 4,</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a679e6f6be41d7a9b12d61e9ec6c5ecf0">   26</a></span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a679e6f6be41d7a9b12d61e9ec6c5ecf0">NotMakingProgressIterations</a> = 5,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">UserAsked</a> = 6</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">   28</a></span>&#160;    };</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar=<span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html">   43</a></span>&#160;<span class="keyword">class </span><a class="code" href="classEigen_1_1HybridNonLinearSolver.html">HybridNonLinearSolver</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">   46</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="namespaceEigen.html#aa06499c94936a19673e53deb516a1b76">DenseIndex</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#aaf90e23a6bad869ca1a9cadf62af0dd4">   48</a></span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#aaf90e23a6bad869ca1a9cadf62af0dd4">HybridNonLinearSolver</a>(FunctorType &amp;_functor)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        : functor(_functor) { <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a68ef73496f04e7a832cda7cdd21dc807">nfev</a>=<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#ac1026391306e8a8038cd40d8763d9e9e">njev</a>=<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a1fb82aaeaf6aa1ae3ab3f7d0b33b4e3f">iter</a> = 0;  <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7472a71945ab2be2a7813c84f63ab871">fnorm</a>= 0.; <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a29cf13648a7d6accc89fd1dc621eb92b">useExternalScaling</a>=<span class="keyword">false</span>;}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html">   51</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html">Parameters</a> {</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a2b18156c78dcdc6e89817a574ff8308d">   52</a></span>&#160;        <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a2b18156c78dcdc6e89817a574ff8308d">Parameters</a>()</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            : <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a69b495ac20715f7ebaf2022a0cd3d6b5">factor</a>(<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(100.))</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            , <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#ad20b6a0b854b93f339d77bc08fc2990b">maxfev</a>(1000)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            , <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a9e94c8adcbe77b10f60d75e9e2520460">xtol</a>(numext::<a class="code" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">sqrt</a>(<a class="code" href="structEigen_1_1NumTraits.html">NumTraits</a>&lt;<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>&gt;::epsilon()))</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            , <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a125218e654873bda27e0106ab309df56">nb_of_subdiagonals</a>(-1)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            , <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a1dcb3e0d548b1be7c6a14decbde75d35">nb_of_superdiagonals</a>(-1)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            , <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a978be043045e930edc9bfb6b86696d7e">epsfcn</a>(<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(0.)) {}</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a69b495ac20715f7ebaf2022a0cd3d6b5">   59</a></span>&#160;        <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a69b495ac20715f7ebaf2022a0cd3d6b5">factor</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#ad20b6a0b854b93f339d77bc08fc2990b">   60</a></span>&#160;        <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#ad20b6a0b854b93f339d77bc08fc2990b">maxfev</a>;   <span class="comment">// maximum number of function evaluation</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a9e94c8adcbe77b10f60d75e9e2520460">   61</a></span>&#160;        <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a9e94c8adcbe77b10f60d75e9e2520460">xtol</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a125218e654873bda27e0106ab309df56">   62</a></span>&#160;        <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a125218e654873bda27e0106ab309df56">nb_of_subdiagonals</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a1dcb3e0d548b1be7c6a14decbde75d35">   63</a></span>&#160;        <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a1dcb3e0d548b1be7c6a14decbde75d35">nb_of_superdiagonals</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a978be043045e930edc9bfb6b86696d7e">   64</a></span>&#160;        <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a978be043045e930edc9bfb6b86696d7e">epsfcn</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    };</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a6b474d4da7339c9aa89cf223796e3a69">   66</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Matrix.html">Matrix&lt; Scalar, Dynamic, 1 &gt;</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a6b474d4da7339c9aa89cf223796e3a69">FVectorType</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a55713d5bb80e014eb649b7d621ab3562">   67</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Matrix.html">Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a55713d5bb80e014eb649b7d621ab3562">JacobianType</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">/* TODO: if eigen provides a triangular storage, use it here */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#afd427708a3c3b71bfbeda613ed68febb">   69</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Matrix.html">Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#afd427708a3c3b71bfbeda613ed68febb">UpperTriangularType</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#aae89b7a004006bad55b8c07fe92e9b8c">hybrj1</a>(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keyword">const</span> <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> tol = <a class="code" href="namespaceEigen_1_1numext.html#a982549ff7a7aa1a72c691bca5ea32ae4">numext::sqrt</a>(<a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;Scalar&gt;::epsilon</a>())</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            );</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a197044e0f63c1077846a0279e47e934f">solveInit</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a64c9d49fa4645ad58a45dedcb1491252">solveOneStep</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a4e1cfd23e2ee4c7e16ed0fd353b3807e">solve</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#ada20835166f9f992a111eecd2f539eff">hybrd1</a>(</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keyword">const</span> <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> tol = <a class="code" href="namespaceEigen_1_1numext.html#a982549ff7a7aa1a72c691bca5ea32ae4">numext::sqrt</a>(<a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;Scalar&gt;::epsilon</a>())</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a03e013471915c4395578affbd2e29e26">solveNumericalDiffInit</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a73ce76462a048e23cdfcd18c18bd187b">solveNumericalDiffOneStep</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a019c209d3c67020247583dce00a5e760">solveNumericalDiff</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a08b1a535646ff113b502b495594782bc">   89</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a08b1a535646ff113b502b495594782bc">resetParameters</a>(<span class="keywordtype">void</span>) { <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a5abdf349cd4c8c144d4e13168d0780c1">parameters</a> = <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html">Parameters</a>(); }</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a5abdf349cd4c8c144d4e13168d0780c1">   90</a></span>&#160;    <a class="code" href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html">Parameters</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a5abdf349cd4c8c144d4e13168d0780c1">parameters</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#aedd9dc3b8e06fa994d94d5a1c4b9786d">   91</a></span>&#160;    <a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a093a1b90bca17c7c35b1715ad5b881a6">fvec</a>, <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#abf7599fb5cced060cc4d5b7ca7f0da59">qtf</a>, <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#aedd9dc3b8e06fa994d94d5a1c4b9786d">diag</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#aba1f6608e9ad2daabfdf9acec571860a">   92</a></span>&#160;    <a class="code" href="classEigen_1_1Matrix.html">JacobianType</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#aba1f6608e9ad2daabfdf9acec571860a">fjac</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a3772d7513630aaa22785129e69505fcd">   93</a></span>&#160;    <a class="code" href="classEigen_1_1Matrix.html">UpperTriangularType</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a3772d7513630aaa22785129e69505fcd">R</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a68ef73496f04e7a832cda7cdd21dc807">   94</a></span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a68ef73496f04e7a832cda7cdd21dc807">nfev</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#ac1026391306e8a8038cd40d8763d9e9e">   95</a></span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#ac1026391306e8a8038cd40d8763d9e9e">njev</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a1fb82aaeaf6aa1ae3ab3f7d0b33b4e3f">   96</a></span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a1fb82aaeaf6aa1ae3ab3f7d0b33b4e3f">iter</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a7472a71945ab2be2a7813c84f63ab871">   97</a></span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7472a71945ab2be2a7813c84f63ab871">fnorm</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a29cf13648a7d6accc89fd1dc621eb92b">   98</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a29cf13648a7d6accc89fd1dc621eb92b">useExternalScaling</a>; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    FunctorType &amp;functor;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> n;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> sum;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">bool</span> sing;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> temp;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> delta;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">bool</span> jeval;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> ncsuc;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> ratio;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> pnorm, xnorm, fnorm1;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> nslow1, nslow2;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> ncfail;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> actred, prered;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="classEigen_1_1Matrix.html">FVectorType</a> wa1, wa2, wa3, wa4;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html">HybridNonLinearSolver</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="classEigen_1_1HybridNonLinearSolver.html">HybridNonLinearSolver</a>&amp;);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;};</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#aae89b7a004006bad55b8c07fe92e9b8c">  122</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#aae89b7a004006bad55b8c07fe92e9b8c">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::hybrj1</a>(</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">const</span> <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> tol</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        )</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>.size();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">/* check the input parameters for errors. */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt;= 0 || tol &lt; 0.)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    resetParameters();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    parameters.maxfev = 100*(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    parameters.xtol = tol;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    diag.setConstant(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, 1.);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    useExternalScaling = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> solve(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a197044e0f63c1077846a0279e47e934f">  143</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a197044e0f63c1077846a0279e47e934f">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::solveInit</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>.size();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    wa1.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); wa2.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); wa3.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); wa4.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    fvec.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    qtf.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    fjac.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (!useExternalScaling)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        diag.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>( (!useExternalScaling || diag.size()==<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>) &amp;&amp; <span class="stringliteral">&quot;When useExternalScaling is set, the caller must provide a valid &#39;diag&#39;&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">/* Function Body */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    nfev = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    njev = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">/*     check the input parameters for errors. */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt;= 0 || parameters.xtol &lt; 0. || parameters.maxfev &lt;= 0 || parameters.factor &lt;= 0. )</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (useExternalScaling)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">if</span> (diag[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;= 0.)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">/*     evaluate the function at the starting point */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">/*     and calculate its norm. */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    nfev = 1;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> ( functor(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>, fvec) &lt; 0)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">HybridNonLinearSolverSpace::UserAsked</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    fnorm = fvec.stableNorm();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">/*     initialize iteration counter and monitors. */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    iter = 1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    ncsuc = 0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ncfail = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    nslow1 = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    nslow2 = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">HybridNonLinearSolverSpace::Running</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a64c9d49fa4645ad58a45dedcb1491252">  186</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a64c9d49fa4645ad58a45dedcb1491252">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::solveOneStep</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">using</span> <a class="code" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">std::abs</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>.size()==<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); <span class="comment">// check the caller is not cheating us</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    std::vector&lt;JacobiRotation&lt;Scalar&gt; &gt; v_givens(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>), w_givens(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    jeval = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">/* calculate the jacobian matrix. */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> ( functor.df(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>, fjac) &lt; 0)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">HybridNonLinearSolverSpace::UserAsked</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    ++njev;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    wa2 = fjac.colwise().blueNorm();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">/* on the first iteration and if external scaling is not used, scale according */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">/* to the norms of the columns of the initial jacobian. */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (iter == 1) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (!useExternalScaling)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                diag[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = (wa2[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]==0.) ? 1. : wa2[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">/* on the first iteration, calculate the norm of the scaled x */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment">/* and initialize the step bound delta. */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        xnorm = diag.cwiseProduct(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>).stableNorm();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        delta = parameters.factor * xnorm;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (delta == 0.)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            delta = parameters.factor;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">/* compute the qr factorization of the jacobian. */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classEigen_1_1HouseholderQR.html">HouseholderQR&lt;JacobianType&gt;</a> qrfac(fjac); <span class="comment">// no pivoting:</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">/* copy the triangular factor of the qr factorization into r. */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    R = qrfac.<a class="code" href="classEigen_1_1HouseholderQR.html#ae837f2fb30099212c53b3042c7d699c9">matrixQR</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">/* accumulate the orthogonal factor in fjac. */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    fjac = qrfac.<a class="code" href="classEigen_1_1HouseholderQR.html#affd506c10ef2d25f56e7b1f9f25ff885">householderQ</a>();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* form (q transpose)*fvec and store in qtf. */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    qtf = fjac.<a class="code" href="classEigen_1_1HouseholderSequence.html#ae0959abb2cfa16c9df2e5782e721811c">transpose</a>() * fvec;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">/* rescale if necessary. */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (!useExternalScaling)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        diag = diag.cwiseMax(wa2);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">/* determine the direction p. */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        internal::dogleg&lt;Scalar&gt;(R, diag, qtf, delta, wa1);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">/* store the direction p and x + p. calculate the norm of p. */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        wa1 = -wa1;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        wa2 = <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a> + wa1;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        pnorm = diag.cwiseProduct(wa1).stableNorm();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">/* on the first iteration, adjust the initial step bound. */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (iter == 1)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            delta = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>)(delta,pnorm);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">/* evaluate the function at x + p and calculate its norm. */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> ( functor(wa2, wa4) &lt; 0)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">HybridNonLinearSolverSpace::UserAsked</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        ++nfev;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        fnorm1 = wa4.stableNorm();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">/* compute the scaled actual reduction. */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        actred = -1.;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">if</span> (fnorm1 &lt; fnorm) <span class="comment">/* Computing 2nd power */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            actred = 1. - <a class="code" href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">numext::abs2</a>(fnorm1 / fnorm);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">/* compute the scaled predicted reduction. */</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        wa3 = R.template triangularView&lt;Upper&gt;()*wa1 + qtf;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        temp = wa3.stableNorm();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        prered = 0.;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">if</span> (temp &lt; fnorm) <span class="comment">/* Computing 2nd power */</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            prered = 1. - <a class="code" href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">numext::abs2</a>(temp / fnorm);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">/* compute the ratio of the actual to the predicted reduction. */</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> = 0.;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">if</span> (prered &gt; 0.)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> = actred / prered;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">/* update the step bound. */</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &lt; <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1)) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            ncsuc = 0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            ++ncfail;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            delta = <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5) * delta;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            ncfail = 0;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            ++ncsuc;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5) || ncsuc &gt; 1)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                delta = (<a class="code" href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>)(delta, pnorm / <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> - 1.) &lt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1)) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                delta = pnorm / <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">/* test for successful iteration. */</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-4)) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="comment">/* successful iteration. update x, fvec, and their norms. */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a> = wa2;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            wa2 = diag.cwiseProduct(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            fvec = wa4;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            xnorm = wa2.stableNorm();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            fnorm = fnorm1;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            ++iter;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">/* determine the progress of the iteration. */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        ++nslow1;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (actred &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.001))</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            nslow1 = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">if</span> (jeval)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            ++nslow2;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span> (actred &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1))</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            nslow2 = 0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">/* test for convergence. */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (delta &lt;= parameters.xtol * xnorm || fnorm == 0.)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689ad5adf33a2f4813fe8a1aa1e9f70e9961">HybridNonLinearSolverSpace::RelativeErrorTooSmall</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">/* tests for termination and stringent tolerances. */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> (nfev &gt;= parameters.maxfev)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a82b971eb0bd71b87dacdf4cd3de8672d">HybridNonLinearSolverSpace::TooManyFunctionEvaluation</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1) * (<a class="code" href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>)(<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1) * delta, pnorm) &lt;= <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;Scalar&gt;::epsilon</a>() * xnorm)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a4ea5d3da0d16abee53bc5ddafdcc65e6">HybridNonLinearSolverSpace::TolTooSmall</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span> (nslow2 == 5)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a9dbd584a67d1457dfe95311188ac631e">HybridNonLinearSolverSpace::NotMakingProgressJacobian</a>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (nslow1 == 10)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a679e6f6be41d7a9b12d61e9ec6c5ecf0">HybridNonLinearSolverSpace::NotMakingProgressIterations</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">/* criterion for recalculating jacobian. */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">if</span> (ncfail == 2)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// leave inner loop and go for the next outer loop iteration</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">/* calculate the rank one modification to the jacobian */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">/* and update qtf if necessary. */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        wa1 = diag.cwiseProduct( diag.cwiseProduct(wa1)/pnorm );</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        wa2 = fjac.transpose() * wa4;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-4))</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            qtf = wa2;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        wa2 = (wa2-wa3)/pnorm;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">/* compute the qr factorization of the updated jacobian. */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        internal::r1updt&lt;Scalar&gt;(R, wa1, v_givens, w_givens, wa2, wa3, &amp;sing);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        internal::r1mpyq&lt;Scalar&gt;(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, fjac.data(), v_givens, w_givens);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        internal::r1mpyq&lt;Scalar&gt;(1, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, qtf.data(), v_givens, w_givens);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        jeval = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">HybridNonLinearSolverSpace::Running</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a4e1cfd23e2ee4c7e16ed0fd353b3807e">  344</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a4e1cfd23e2ee4c7e16ed0fd353b3807e">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::solve</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> status = solveInit(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (status==<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">while</span> (status==<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">HybridNonLinearSolverSpace::Running</a>)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        status = solveOneStep(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#ada20835166f9f992a111eecd2f539eff">  358</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#ada20835166f9f992a111eecd2f539eff">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::hybrd1</a>(</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">const</span> <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a> tol</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        )</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>.size();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">/* check the input parameters for errors. */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt;= 0 || tol &lt; 0.)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    resetParameters();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    parameters.maxfev = 200*(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>+1);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    parameters.xtol = tol;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    diag.setConstant(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, 1.);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    useExternalScaling = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">return</span> solveNumericalDiff(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a03e013471915c4395578affbd2e29e26">  380</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a03e013471915c4395578affbd2e29e26">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::solveNumericalDiffInit</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>.size();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (parameters.nb_of_subdiagonals&lt;0) parameters.nb_of_subdiagonals= <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>-1;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (parameters.nb_of_superdiagonals&lt;0) parameters.nb_of_superdiagonals= <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>-1;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    wa1.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); wa2.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); wa3.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); wa4.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    qtf.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    fjac.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    fvec.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span> (!useExternalScaling)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        diag.resize(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>( (!useExternalScaling || diag.size()==<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>) &amp;&amp; <span class="stringliteral">&quot;When useExternalScaling is set, the caller must provide a valid &#39;diag&#39;&quot;</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">/* Function Body */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    nfev = 0;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    njev = 0;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">/*     check the input parameters for errors. */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> &lt;= 0 || parameters.xtol &lt; 0. || parameters.maxfev &lt;= 0 || parameters.nb_of_subdiagonals&lt; 0 || parameters.nb_of_superdiagonals&lt; 0 || parameters.factor &lt;= 0. )</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span> (useExternalScaling)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">if</span> (diag[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;= 0.)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">/*     evaluate the function at the starting point */</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">/*     and calculate its norm. */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    nfev = 1;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> ( functor(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>, fvec) &lt; 0)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">HybridNonLinearSolverSpace::UserAsked</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    fnorm = fvec.stableNorm();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">/*     initialize iteration counter and monitors. */</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    iter = 1;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    ncsuc = 0;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    ncfail = 0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    nslow1 = 0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    nslow2 = 0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">HybridNonLinearSolverSpace::Running</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a73ce76462a048e23cdfcd18c18bd187b">  426</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a73ce76462a048e23cdfcd18c18bd187b">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::solveNumericalDiffOneStep</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">std::sqrt</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keyword">using</span> <a class="code" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">std::abs</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    assert(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>.size()==<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>); <span class="comment">// check the caller is not cheating us</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    std::vector&lt;JacobiRotation&lt;Scalar&gt; &gt; v_givens(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>), w_givens(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    jeval = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> (parameters.nb_of_subdiagonals&lt;0) parameters.nb_of_subdiagonals= <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>-1;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> (parameters.nb_of_superdiagonals&lt;0) parameters.nb_of_superdiagonals= <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>-1;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">/* calculate the jacobian matrix. */</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceEigen_1_1internal.html#a905c2bc7dcf22a3b089d7ab903d514e6">internal::fdjac1</a>(functor, <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>, fvec, fjac, parameters.nb_of_subdiagonals, parameters.nb_of_superdiagonals, parameters.epsfcn) &lt;0)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">HybridNonLinearSolverSpace::UserAsked</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    nfev += (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>)(parameters.nb_of_subdiagonals+parameters.nb_of_superdiagonals+ 1, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    wa2 = fjac.colwise().blueNorm();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">/* on the first iteration and if external scaling is not used, scale according */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">/* to the norms of the columns of the initial jacobian. */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (iter == 1) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span> (!useExternalScaling)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                diag[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = (wa2[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]==0.) ? 1. : wa2[<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">/* on the first iteration, calculate the norm of the scaled x */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">/* and initialize the step bound delta. */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        xnorm = diag.cwiseProduct(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>).stableNorm();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        delta = parameters.factor * xnorm;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">if</span> (delta == 0.)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            delta = parameters.factor;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">/* compute the qr factorization of the jacobian. */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="classEigen_1_1HouseholderQR.html">HouseholderQR&lt;JacobianType&gt;</a> qrfac(fjac); <span class="comment">// no pivoting:</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">/* copy the triangular factor of the qr factorization into r. */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    R = qrfac.<a class="code" href="classEigen_1_1HouseholderQR.html#ae837f2fb30099212c53b3042c7d699c9">matrixQR</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">/* accumulate the orthogonal factor in fjac. */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    fjac = qrfac.<a class="code" href="classEigen_1_1HouseholderQR.html#affd506c10ef2d25f56e7b1f9f25ff885">householderQ</a>();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">/* form (q transpose)*fvec and store in qtf. */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    qtf = fjac.<a class="code" href="classEigen_1_1HouseholderSequence.html#ae0959abb2cfa16c9df2e5782e721811c">transpose</a>() * fvec;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">/* rescale if necessary. */</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (!useExternalScaling)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        diag = diag.cwiseMax(wa2);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">/* determine the direction p. */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        internal::dogleg&lt;Scalar&gt;(R, diag, qtf, delta, wa1);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">/* store the direction p and x + p. calculate the norm of p. */</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        wa1 = -wa1;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        wa2 = <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a> + wa1;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        pnorm = diag.cwiseProduct(wa1).stableNorm();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment">/* on the first iteration, adjust the initial step bound. */</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span> (iter == 1)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            delta = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>)(delta,pnorm);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">/* evaluate the function at x + p and calculate its norm. */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span> ( functor(wa2, wa4) &lt; 0)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">HybridNonLinearSolverSpace::UserAsked</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        ++nfev;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        fnorm1 = wa4.stableNorm();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">/* compute the scaled actual reduction. */</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        actred = -1.;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">if</span> (fnorm1 &lt; fnorm) <span class="comment">/* Computing 2nd power */</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            actred = 1. - <a class="code" href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">numext::abs2</a>(fnorm1 / fnorm);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">/* compute the scaled predicted reduction. */</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        wa3 = R.template triangularView&lt;Upper&gt;()*wa1 + qtf;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        temp = wa3.stableNorm();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        prered = 0.;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (temp &lt; fnorm) <span class="comment">/* Computing 2nd power */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            prered = 1. - <a class="code" href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">numext::abs2</a>(temp / fnorm);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">/* compute the ratio of the actual to the predicted reduction. */</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> = 0.;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">if</span> (prered &gt; 0.)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> = actred / prered;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">/* update the step bound. */</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &lt; <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1)) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            ncsuc = 0;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            ++ncfail;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            delta = <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5) * delta;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            ncfail = 0;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            ++ncsuc;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5) || ncsuc &gt; 1)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                delta = (<a class="code" href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>)(delta, pnorm / <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> - 1.) &lt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1)) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                delta = pnorm / <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.5);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">/* test for successful iteration. */</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-4)) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="comment">/* successful iteration. update x, fvec, and their norms. */</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a> = wa2;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            wa2 = diag.cwiseProduct(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            fvec = wa4;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            xnorm = wa2.stableNorm();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            fnorm = fnorm1;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            ++iter;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">/* determine the progress of the iteration. */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        ++nslow1;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (actred &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.001))</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            nslow1 = 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span> (jeval)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            ++nslow2;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">if</span> (actred &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1))</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            nslow2 = 0;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">/* test for convergence. */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">if</span> (delta &lt;= parameters.xtol * xnorm || fnorm == 0.)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689ad5adf33a2f4813fe8a1aa1e9f70e9961">HybridNonLinearSolverSpace::RelativeErrorTooSmall</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">/* tests for termination and stringent tolerances. */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">if</span> (nfev &gt;= parameters.maxfev)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a82b971eb0bd71b87dacdf4cd3de8672d">HybridNonLinearSolverSpace::TooManyFunctionEvaluation</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1) * (<a class="code" href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>)(<a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(.1) * delta, pnorm) &lt;= <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;Scalar&gt;::epsilon</a>() * xnorm)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a4ea5d3da0d16abee53bc5ddafdcc65e6">HybridNonLinearSolverSpace::TolTooSmall</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">if</span> (nslow2 == 5)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a9dbd584a67d1457dfe95311188ac631e">HybridNonLinearSolverSpace::NotMakingProgressJacobian</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">if</span> (nslow1 == 10)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a679e6f6be41d7a9b12d61e9ec6c5ecf0">HybridNonLinearSolverSpace::NotMakingProgressIterations</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">/* criterion for recalculating jacobian. */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (ncfail == 2)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// leave inner loop and go for the next outer loop iteration</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="comment">/* calculate the rank one modification to the jacobian */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">/* and update qtf if necessary. */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        wa1 = diag.cwiseProduct( diag.cwiseProduct(wa1)/pnorm );</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        wa2 = fjac.transpose() * wa4;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a> &gt;= <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a>(1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-4))</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            qtf = wa2;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        wa2 = (wa2-wa3)/pnorm;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">/* compute the qr factorization of the updated jacobian. */</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        internal::r1updt&lt;Scalar&gt;(R, wa1, v_givens, w_givens, wa2, wa3, &amp;sing);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        internal::r1mpyq&lt;Scalar&gt;(<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, fjac.data(), v_givens, w_givens);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        internal::r1mpyq&lt;Scalar&gt;(1, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, qtf.data(), v_givens, w_givens);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        jeval = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">HybridNonLinearSolverSpace::Running</a>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> FunctorType, <span class="keyword">typename</span> Scalar&gt;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a></div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="classEigen_1_1HybridNonLinearSolver.html#a019c209d3c67020247583dce00a5e760">  587</a></span>&#160;<a class="code" href="classEigen_1_1HybridNonLinearSolver.html#a019c209d3c67020247583dce00a5e760">HybridNonLinearSolver&lt;FunctorType,Scalar&gt;::solveNumericalDiff</a>(<a class="code" href="classEigen_1_1Matrix.html">FVectorType</a>  &amp;<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">HybridNonLinearSolverSpace::Status</a> status = solveNumericalDiffInit(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (status==<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">HybridNonLinearSolverSpace::ImproperInputParameters</a>)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">while</span> (status==<a class="code" href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">HybridNonLinearSolverSpace::Running</a>)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        status = solveNumericalDiffOneStep(<a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;} <span class="comment">// end namespace Eigen</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// EIGEN_HYBRIDNONLINEARSOLVER_H</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">//vim: ai ts=4 sts=4 et sw=4</span></div>
<div class="ttc" id="aBiCGSTAB__simple_8cpp_html_a5150192f625f4d7970d61169b9567f39"><div class="ttname"><a href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_simple.cpp:1</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_aa9e3025f5efca2c2a39d785652f2d710"><div class="ttname"><a href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aMacros_8h_html_acaa7ba89800cfe18d5fd6eed620aea9c"><div class="ttname"><a href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a></div><div class="ttdeci">#define eigen_assert(x)</div><div class="ttdef"><b>Definition:</b> Macros.h:1037</div></div>
<div class="ttc" id="abench__gemm_8cpp_html_a052eb942d12b6404aade6fae4b075fb9"><div class="ttname"><a href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a></div><div class="ttdeci">SCALAR Scalar</div><div class="ttdef"><b>Definition:</b> bench_gemm.cpp:46</div></div>
<div class="ttc" id="aclassEigen_1_1HouseholderQR_html"><div class="ttname"><a href="classEigen_1_1HouseholderQR.html">Eigen::HouseholderQR</a></div><div class="ttdoc">Householder QR decomposition of a matrix.</div><div class="ttdef"><b>Definition:</b> HouseholderQR.h:58</div></div>
<div class="ttc" id="aclassEigen_1_1HouseholderQR_html_ae837f2fb30099212c53b3042c7d699c9"><div class="ttname"><a href="classEigen_1_1HouseholderQR.html#ae837f2fb30099212c53b3042c7d699c9">Eigen::HouseholderQR::matrixQR</a></div><div class="ttdeci">const MatrixType &amp; matrixQR() const</div><div class="ttdef"><b>Definition:</b> HouseholderQR.h:172</div></div>
<div class="ttc" id="aclassEigen_1_1HouseholderQR_html_affd506c10ef2d25f56e7b1f9f25ff885"><div class="ttname"><a href="classEigen_1_1HouseholderQR.html#affd506c10ef2d25f56e7b1f9f25ff885">Eigen::HouseholderQR::householderQ</a></div><div class="ttdeci">HouseholderSequenceType householderQ() const</div><div class="ttdef"><b>Definition:</b> HouseholderQR.h:163</div></div>
<div class="ttc" id="aclassEigen_1_1HouseholderSequence_html_ae0959abb2cfa16c9df2e5782e721811c"><div class="ttname"><a href="classEigen_1_1HouseholderSequence.html#ae0959abb2cfa16c9df2e5782e721811c">Eigen::HouseholderSequence::transpose</a></div><div class="ttdeci">TransposeReturnType transpose() const</div><div class="ttdoc">Transpose of the Householder sequence.</div><div class="ttdef"><b>Definition:</b> HouseholderSequence.h:236</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html">Eigen::HybridNonLinearSolver</a></div><div class="ttdoc">Finds a zero of a system of n nonlinear functions in n variables by a modification of the Powell hybr...</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:44</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a019c209d3c67020247583dce00a5e760"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a019c209d3c67020247583dce00a5e760">Eigen::HybridNonLinearSolver::solveNumericalDiff</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status solveNumericalDiff(FVectorType &amp;x)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:587</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a03e013471915c4395578affbd2e29e26"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a03e013471915c4395578affbd2e29e26">Eigen::HybridNonLinearSolver::solveNumericalDiffInit</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status solveNumericalDiffInit(FVectorType &amp;x)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:380</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a08b1a535646ff113b502b495594782bc"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a08b1a535646ff113b502b495594782bc">Eigen::HybridNonLinearSolver::resetParameters</a></div><div class="ttdeci">void resetParameters(void)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:89</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a093a1b90bca17c7c35b1715ad5b881a6"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a093a1b90bca17c7c35b1715ad5b881a6">Eigen::HybridNonLinearSolver::fvec</a></div><div class="ttdeci">FVectorType fvec</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:91</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a197044e0f63c1077846a0279e47e934f"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a197044e0f63c1077846a0279e47e934f">Eigen::HybridNonLinearSolver::solveInit</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status solveInit(FVectorType &amp;x)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:143</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a1fb82aaeaf6aa1ae3ab3f7d0b33b4e3f"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a1fb82aaeaf6aa1ae3ab3f7d0b33b4e3f">Eigen::HybridNonLinearSolver::iter</a></div><div class="ttdeci">Index iter</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:96</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a29cf13648a7d6accc89fd1dc621eb92b"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a29cf13648a7d6accc89fd1dc621eb92b">Eigen::HybridNonLinearSolver::useExternalScaling</a></div><div class="ttdeci">bool useExternalScaling</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:98</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a3772d7513630aaa22785129e69505fcd"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a3772d7513630aaa22785129e69505fcd">Eigen::HybridNonLinearSolver::R</a></div><div class="ttdeci">UpperTriangularType R</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:93</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a4e1cfd23e2ee4c7e16ed0fd353b3807e"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a4e1cfd23e2ee4c7e16ed0fd353b3807e">Eigen::HybridNonLinearSolver::solve</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status solve(FVectorType &amp;x)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:344</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a55713d5bb80e014eb649b7d621ab3562"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a55713d5bb80e014eb649b7d621ab3562">Eigen::HybridNonLinearSolver::JacobianType</a></div><div class="ttdeci">Matrix&lt; Scalar, Dynamic, Dynamic &gt; JacobianType</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:67</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a5abdf349cd4c8c144d4e13168d0780c1"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a5abdf349cd4c8c144d4e13168d0780c1">Eigen::HybridNonLinearSolver::parameters</a></div><div class="ttdeci">Parameters parameters</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:90</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a64c9d49fa4645ad58a45dedcb1491252"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a64c9d49fa4645ad58a45dedcb1491252">Eigen::HybridNonLinearSolver::solveOneStep</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status solveOneStep(FVectorType &amp;x)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:186</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a68ef73496f04e7a832cda7cdd21dc807"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a68ef73496f04e7a832cda7cdd21dc807">Eigen::HybridNonLinearSolver::nfev</a></div><div class="ttdeci">Index nfev</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:94</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a6b474d4da7339c9aa89cf223796e3a69"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a6b474d4da7339c9aa89cf223796e3a69">Eigen::HybridNonLinearSolver::FVectorType</a></div><div class="ttdeci">Matrix&lt; Scalar, Dynamic, 1 &gt; FVectorType</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:66</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a73ce76462a048e23cdfcd18c18bd187b"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a73ce76462a048e23cdfcd18c18bd187b">Eigen::HybridNonLinearSolver::solveNumericalDiffOneStep</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status solveNumericalDiffOneStep(FVectorType &amp;x)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:426</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a7472a71945ab2be2a7813c84f63ab871"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a7472a71945ab2be2a7813c84f63ab871">Eigen::HybridNonLinearSolver::fnorm</a></div><div class="ttdeci">Scalar fnorm</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:97</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_a7d18b9b4dfd016ba552961903afd40e2"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#a7d18b9b4dfd016ba552961903afd40e2">Eigen::HybridNonLinearSolver::Index</a></div><div class="ttdeci">DenseIndex Index</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:46</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_aae89b7a004006bad55b8c07fe92e9b8c"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#aae89b7a004006bad55b8c07fe92e9b8c">Eigen::HybridNonLinearSolver::hybrj1</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status hybrj1(FVectorType &amp;x, const Scalar tol=numext::sqrt(NumTraits&lt; Scalar &gt;::epsilon()))</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:122</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_aaf90e23a6bad869ca1a9cadf62af0dd4"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#aaf90e23a6bad869ca1a9cadf62af0dd4">Eigen::HybridNonLinearSolver::HybridNonLinearSolver</a></div><div class="ttdeci">HybridNonLinearSolver(FunctorType &amp;_functor)</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:48</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_aba1f6608e9ad2daabfdf9acec571860a"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#aba1f6608e9ad2daabfdf9acec571860a">Eigen::HybridNonLinearSolver::fjac</a></div><div class="ttdeci">JacobianType fjac</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:92</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_abf7599fb5cced060cc4d5b7ca7f0da59"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#abf7599fb5cced060cc4d5b7ca7f0da59">Eigen::HybridNonLinearSolver::qtf</a></div><div class="ttdeci">FVectorType qtf</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:91</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_ac1026391306e8a8038cd40d8763d9e9e"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#ac1026391306e8a8038cd40d8763d9e9e">Eigen::HybridNonLinearSolver::njev</a></div><div class="ttdeci">Index njev</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:95</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_ada20835166f9f992a111eecd2f539eff"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#ada20835166f9f992a111eecd2f539eff">Eigen::HybridNonLinearSolver::hybrd1</a></div><div class="ttdeci">HybridNonLinearSolverSpace::Status hybrd1(FVectorType &amp;x, const Scalar tol=numext::sqrt(NumTraits&lt; Scalar &gt;::epsilon()))</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:358</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_aedd9dc3b8e06fa994d94d5a1c4b9786d"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#aedd9dc3b8e06fa994d94d5a1c4b9786d">Eigen::HybridNonLinearSolver::diag</a></div><div class="ttdeci">FVectorType diag</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:91</div></div>
<div class="ttc" id="aclassEigen_1_1HybridNonLinearSolver_html_afd427708a3c3b71bfbeda613ed68febb"><div class="ttname"><a href="classEigen_1_1HybridNonLinearSolver.html#afd427708a3c3b71bfbeda613ed68febb">Eigen::HybridNonLinearSolver::UpperTriangularType</a></div><div class="ttdeci">Matrix&lt; Scalar, Dynamic, Dynamic &gt; UpperTriangularType</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:69</div></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, 1 &gt;</a></div></div>
<div class="ttc" id="adatatypes_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="datatypes_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> datatypes.h:17</div></div>
<div class="ttc" id="adatatypes_8h_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:19</div></div>
<div class="ttc" id="adatatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:20</div></div>
<div class="ttc" id="agnuplot__common__settings_8hh_html_a5fd331c99e778f04762be6d8173eb4d2"><div class="ttname"><a href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a></div><div class="ttdeci">set noclip points set clip one set noclip two set bar set border lt lw set xdata set ydata set zdata set x2data set y2data set boxwidth set dummy x</div><div class="ttdef"><b>Definition:</b> gnuplot_common_settings.hh:12</div></div>
<div class="ttc" id="agnuplot__common__settings_8hh_html_aad2e6a991f10fa61eab8e835c7088caf"><div class="ttname"><a href="gnuplot__common__settings_8hh.html#aad2e6a991f10fa61eab8e835c7088caf">ratio</a></div><div class="ttdeci">set noclip points set clip one set noclip two set bar set border lt lw set xdata set ydata set zdata set x2data set y2data set boxwidth set dummy y set format x g set format y g set format x2 g set format y2 g set format z g set angles radians set nogrid set key title set key left top Right noreverse box linetype linewidth samplen spacing width set nolabel set noarrow set nologscale set logscale x set set pointsize set encoding default set nopolar set noparametric set set set set surface set nocontour set clabel set mapping cartesian set nohidden3d set cntrparam order set cntrparam linear set cntrparam levels auto set cntrparam points set size ratio</div><div class="ttdef"><b>Definition:</b> gnuplot_common_settings.hh:44</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689">Eigen::HybridNonLinearSolverSpace::Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:19</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a1790497cbbfea43da7617bcf010280d5">Eigen::HybridNonLinearSolverSpace::ImproperInputParameters</a></div><div class="ttdeci">@ ImproperInputParameters</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:21</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a4ea5d3da0d16abee53bc5ddafdcc65e6"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a4ea5d3da0d16abee53bc5ddafdcc65e6">Eigen::HybridNonLinearSolverSpace::TolTooSmall</a></div><div class="ttdeci">@ TolTooSmall</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:24</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a54bd7f9ebd8df668ef1b37476827d3a9">Eigen::HybridNonLinearSolverSpace::UserAsked</a></div><div class="ttdeci">@ UserAsked</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:27</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a5b3625d5ffa63ea0d5e4db4cab42e02b">Eigen::HybridNonLinearSolverSpace::Running</a></div><div class="ttdeci">@ Running</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:20</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a679e6f6be41d7a9b12d61e9ec6c5ecf0"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a679e6f6be41d7a9b12d61e9ec6c5ecf0">Eigen::HybridNonLinearSolverSpace::NotMakingProgressIterations</a></div><div class="ttdeci">@ NotMakingProgressIterations</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:26</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a82b971eb0bd71b87dacdf4cd3de8672d"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a82b971eb0bd71b87dacdf4cd3de8672d">Eigen::HybridNonLinearSolverSpace::TooManyFunctionEvaluation</a></div><div class="ttdeci">@ TooManyFunctionEvaluation</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:23</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689a9dbd584a67d1457dfe95311188ac631e"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689a9dbd584a67d1457dfe95311188ac631e">Eigen::HybridNonLinearSolverSpace::NotMakingProgressJacobian</a></div><div class="ttdeci">@ NotMakingProgressJacobian</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:25</div></div>
<div class="ttc" id="anamespaceEigen_1_1HybridNonLinearSolverSpace_html_aaf2facedf2b80e1d4381bc5979e88689ad5adf33a2f4813fe8a1aa1e9f70e9961"><div class="ttname"><a href="namespaceEigen_1_1HybridNonLinearSolverSpace.html#aaf2facedf2b80e1d4381bc5979e88689ad5adf33a2f4813fe8a1aa1e9f70e9961">Eigen::HybridNonLinearSolverSpace::RelativeErrorTooSmall</a></div><div class="ttdeci">@ RelativeErrorTooSmall</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:22</div></div>
<div class="ttc" id="anamespaceEigen_1_1bfloat16__impl_html_ab03218ad82a11c00ab667d0fe2c345cf"><div class="ttname"><a href="namespaceEigen_1_1bfloat16__impl.html#ab03218ad82a11c00ab667d0fe2c345cf">Eigen::bfloat16_impl::sqrt</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC bfloat16 sqrt(const bfloat16 &amp;a)</div><div class="ttdef"><b>Definition:</b> BFloat16.h:511</div></div>
<div class="ttc" id="anamespaceEigen_1_1internal_html_a905c2bc7dcf22a3b089d7ab903d514e6"><div class="ttname"><a href="namespaceEigen_1_1internal.html#a905c2bc7dcf22a3b089d7ab903d514e6">Eigen::internal::fdjac1</a></div><div class="ttdeci">DenseIndex fdjac1(const FunctorType &amp;Functor, Matrix&lt; Scalar, Dynamic, 1 &gt; &amp;x, Matrix&lt; Scalar, Dynamic, 1 &gt; &amp;fvec, Matrix&lt; Scalar, Dynamic, Dynamic &gt; &amp;fjac, DenseIndex ml, DenseIndex mu, Scalar epsfcn)</div><div class="ttdef"><b>Definition:</b> fdjac1.h:6</div></div>
<div class="ttc" id="anamespaceEigen_1_1numext_html_a982549ff7a7aa1a72c691bca5ea32ae4"><div class="ttname"><a href="namespaceEigen_1_1numext.html#a982549ff7a7aa1a72c691bca5ea32ae4">Eigen::numext::sqrt</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_ALWAYS_INLINE float sqrt(const float &amp;x)</div><div class="ttdef"><b>Definition:</b> MathFunctions.h:177</div></div>
<div class="ttc" id="anamespaceEigen_1_1numext_html_ad59216129a430099e97b4c4b1e2f2984"><div class="ttname"><a href="namespaceEigen_1_1numext.html#ad59216129a430099e97b4c4b1e2f2984">Eigen::numext::abs2</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC bool abs2(bool x)</div><div class="ttdef"><b>Definition:</b> MathFunctions.h:1292</div></div>
<div class="ttc" id="anamespaceEigen_html"><div class="ttname"><a href="namespaceEigen.html">Eigen</a></div><div class="ttdoc">Namespace containing all symbols from the Eigen library.</div><div class="ttdef"><b>Definition:</b> bench_norm.cpp:85</div></div>
<div class="ttc" id="anamespaceEigen_html_aa06499c94936a19673e53deb516a1b76"><div class="ttname"><a href="namespaceEigen.html#aa06499c94936a19673e53deb516a1b76">Eigen::DenseIndex</a></div><div class="ttdeci">EIGEN_DEFAULT_DENSE_INDEX_TYPE DenseIndex</div><div class="ttdef"><b>Definition:</b> Meta.h:66</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html">Eigen::HybridNonLinearSolver::Parameters</a></div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:51</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_a125218e654873bda27e0106ab309df56"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a125218e654873bda27e0106ab309df56">Eigen::HybridNonLinearSolver::Parameters::nb_of_subdiagonals</a></div><div class="ttdeci">Index nb_of_subdiagonals</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:62</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_a1dcb3e0d548b1be7c6a14decbde75d35"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a1dcb3e0d548b1be7c6a14decbde75d35">Eigen::HybridNonLinearSolver::Parameters::nb_of_superdiagonals</a></div><div class="ttdeci">Index nb_of_superdiagonals</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:63</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_a2b18156c78dcdc6e89817a574ff8308d"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a2b18156c78dcdc6e89817a574ff8308d">Eigen::HybridNonLinearSolver::Parameters::Parameters</a></div><div class="ttdeci">Parameters()</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:52</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_a69b495ac20715f7ebaf2022a0cd3d6b5"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a69b495ac20715f7ebaf2022a0cd3d6b5">Eigen::HybridNonLinearSolver::Parameters::factor</a></div><div class="ttdeci">Scalar factor</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:59</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_a978be043045e930edc9bfb6b86696d7e"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a978be043045e930edc9bfb6b86696d7e">Eigen::HybridNonLinearSolver::Parameters::epsfcn</a></div><div class="ttdeci">Scalar epsfcn</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:64</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_a9e94c8adcbe77b10f60d75e9e2520460"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#a9e94c8adcbe77b10f60d75e9e2520460">Eigen::HybridNonLinearSolver::Parameters::xtol</a></div><div class="ttdeci">Scalar xtol</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:61</div></div>
<div class="ttc" id="astructEigen_1_1HybridNonLinearSolver_1_1Parameters_html_ad20b6a0b854b93f339d77bc08fc2990b"><div class="ttname"><a href="structEigen_1_1HybridNonLinearSolver_1_1Parameters.html#ad20b6a0b854b93f339d77bc08fc2990b">Eigen::HybridNonLinearSolver::Parameters::maxfev</a></div><div class="ttdeci">Index maxfev</div><div class="ttdef"><b>Definition:</b> HybridNonLinearSolver.h:60</div></div>
<div class="ttc" id="astructEigen_1_1NumTraits_html"><div class="ttname"><a href="structEigen_1_1NumTraits.html">Eigen::NumTraits</a></div><div class="ttdoc">Holds information about the various numeric (i.e. scalar) types allowed by Eigen.</div><div class="ttdef"><b>Definition:</b> NumTraits.h:233</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
