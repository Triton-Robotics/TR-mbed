infantry-build:
	cmake --build cmake-build-debug --target TR-Infantry -j $(nproc)

testbench-build:
	cmake --build cmake-build-debug --target TR-TestBench -j $(nproc)

hero-build:
	cmake --build cmake-build-debug --target TR-Hero -j $(nproc)

sentry-build:
	cmake --build cmake-build-debug --target TR-Sentry -j $(nproc)

infantry-jlink: infantry-build
	powershell.exe -Command "powershell.exe -Command "jlink.exe 'C:\Program Files\SEGGER\JLink_V898\JLink.exe' -device STM32F446RE -if SWD -speed 4000 -CommanderScript (wslpath -w './JLink/flashInf.jlink')"

sentry-jlink: sentry-build
	powershell.exe -Command "powershell.exe -Command "jlink.exe 'C:\Program Files\SEGGER\JLink_V898\JLink.exe' -device STM32F446RE -if SWD -speed 4000 -CommanderScript (wslpath -w './JLink/flashSen.jlink')"

hero-jlink: hero-build
	powershell.exe -Command "powershell.exe -Command "jlink.exe 'C:\Program Files\SEGGER\JLink_V898\JLink.exe' -device STM32F446RE -if SWD -speed 4000 -CommanderScript (wslpath -w './JLink/flashHero.jlink')"

testbench-jlink: testbench-build
	powershell.exe -Command "powershell.exe -Command "jlink.exe 'C:\Program Files\SEGGER\JLink_V898\JLink.exe' -device STM32F446RE -if SWD -speed 4000 -CommanderScript (wslpath -w './JLink/flashTest.jlink')"

infantry: infantry-build    
	powershell.exe /c cp cmake-build-debug/robots/Infantry/TR-Infantry.bin C:

testbench: testbench-build
	powershell.exe /c cp cmake-build-debug/robots/TestBench/TR-TestBench.bin C:

hero: hero-build
	powershell.exe /c cp cmake-build-debug/robots/Hero/TR-Hero.bin C:

sentry: sentry-build
	powershell.exe /c cp cmake-build-debug/robots/Sentry/TR-Sentry.bin C

infantry-pi: infantry-build
	scp cmake-build-debug/robots/Infantry/TR-Infantry.bin pi:/media/anshal/NOD_F446RE

testbench-pi: testbench-build
	scp cmake-build-debug/robots/TestBench/TR-TestBench.bin pi:/media/anshal/NOD_F446RE

hero-pi: hero-build
	scp cmake-build-debug/robots/Hero/TR-Hero.bin pi:/media/anshal/NOD_F446RE

sentry-pi: sentry-build
	scp cmake-build-debug/robots/Sentry/TR-Sentry.bin pi:/media/anshal/NOD_F446RE2

serial:
	powershell.exe /c mbed-tools sterm -b 115200

bind:
	cmd.exe /c usbipd attach --wsl --busid 2-2

mount:
	sudo mount E: /mnt/e